<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Geophysical Fluid Dynamics (GFD) | mushetty.me</title>
<meta name="keywords" content="">
<meta name="description" content="Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.
 Administrative Stuff Chapter 1  Material Derivative (Lagrangian Derivative) Conservation of Mass Momentum Equation Equation of State Sound Waves   Chapter 2  Why a rotating frame? Derivation of Velocity and Acceleration in Rotating Frames Fluid Equations in Rotating Frame  Encoding The Spherical Earth in Equations Primitive Equations (Dynamical Core, because you can&rsquo;t get rid of the air)  What is $\vec{f}$ physically     Stratification  Boussinesq Equation Anelastic Equations   Alternative Vertical Coordinates    Administrative Stuff  Office Hours: Engineering Terrace 287 on Thursdays during class time (4:00-5:00 PM) TA: Eojin Lee el3080[at]columbia.">
<meta name="author" content="">
<link rel="canonical" href="https://mushetty.me/notes/geophysics/geophysics/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a5456a2fb6485e28d3190c101c9f7fea21d7eddeb7cf1b8dddf20aeb314df0cf.css" integrity="sha256-pUVqL7ZIXijTGQwQHJ9/6iHX7d63zxuN3fIK6zFN8M8=" rel="preload stylesheet" as="style">
<link rel="stylesheet" href="" />
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://mushetty.me/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://mushetty.me/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://mushetty.me/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://mushetty.me/apple-touch-icon.png">
<link rel="mask-icon" href="https://mushetty.me/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>


<meta property="og:title" content="Geophysical Fluid Dynamics (GFD)" />
<meta property="og:description" content="Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.
 Administrative Stuff Chapter 1  Material Derivative (Lagrangian Derivative) Conservation of Mass Momentum Equation Equation of State Sound Waves   Chapter 2  Why a rotating frame? Derivation of Velocity and Acceleration in Rotating Frames Fluid Equations in Rotating Frame  Encoding The Spherical Earth in Equations Primitive Equations (Dynamical Core, because you can&rsquo;t get rid of the air)  What is $\vec{f}$ physically     Stratification  Boussinesq Equation Anelastic Equations   Alternative Vertical Coordinates    Administrative Stuff  Office Hours: Engineering Terrace 287 on Thursdays during class time (4:00-5:00 PM) TA: Eojin Lee el3080[at]columbia." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mushetty.me/notes/geophysics/geophysics/" /><meta property="article:section" content="notes" />
<meta property="article:published_time" content="2023-01-17T22:19:05-05:00" />
<meta property="article:modified_time" content="2023-02-08T10:45:09-05:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Geophysical Fluid Dynamics (GFD)"/>
<meta name="twitter:description" content="Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.
 Administrative Stuff Chapter 1  Material Derivative (Lagrangian Derivative) Conservation of Mass Momentum Equation Equation of State Sound Waves   Chapter 2  Why a rotating frame? Derivation of Velocity and Acceleration in Rotating Frames Fluid Equations in Rotating Frame  Encoding The Spherical Earth in Equations Primitive Equations (Dynamical Core, because you can&rsquo;t get rid of the air)  What is $\vec{f}$ physically     Stratification  Boussinesq Equation Anelastic Equations   Alternative Vertical Coordinates    Administrative Stuff  Office Hours: Engineering Terrace 287 on Thursdays during class time (4:00-5:00 PM) TA: Eojin Lee el3080[at]columbia."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Geophysical Fluid Dynamics (GFD)",
      "item": "https://mushetty.me/notes/geophysics/geophysics/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Geophysical Fluid Dynamics (GFD)",
  "name": "Geophysical Fluid Dynamics (GFD)",
  "description": "Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.\n Administrative Stuff Chapter 1  Material Derivative (Lagrangian Derivative) Conservation of Mass Momentum Equation Equation of State Sound Waves   Chapter 2  Why a rotating frame? Derivation of Velocity and Acceleration in Rotating Frames Fluid Equations in Rotating Frame  Encoding The Spherical Earth in Equations Primitive Equations (Dynamical Core, because you can\u0026rsquo;t get rid of the air)  What is $\\vec{f}$ physically     Stratification  Boussinesq Equation Anelastic Equations   Alternative Vertical Coordinates    Administrative Stuff  Office Hours: Engineering Terrace 287 on Thursdays during class time (4:00-5:00 PM) TA: Eojin Lee el3080[at]columbia.",
  "keywords": [
    
  ],
  "articleBody": "Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.\n Administrative Stuff Chapter 1  Material Derivative (Lagrangian Derivative) Conservation of Mass Momentum Equation Equation of State Sound Waves   Chapter 2  Why a rotating frame? Derivation of Velocity and Acceleration in Rotating Frames Fluid Equations in Rotating Frame  Encoding The Spherical Earth in Equations Primitive Equations (Dynamical Core, because you can’t get rid of the air)  What is $\\vec{f}$ physically     Stratification  Boussinesq Equation Anelastic Equations   Alternative Vertical Coordinates    Administrative Stuff  Office Hours: Engineering Terrace 287 on Thursdays during class time (4:00-5:00 PM) TA: Eojin Lee el3080[at]columbia.edu Primary Textbook: Geoff Vallis: Atmospheric and Oceanic Fluid Dynamics 1st Edition (pdf available on Columbia Library)  Course covers Ch 1-6. Maybe Ch 8.   Other texts:  J. Pedlosky: GFD Adrian Gill: Atmosphere Ocean Dynamics More Specialized  Rich Salmon Jim McWilliams Benoit Cushman-Roisin     Grading Scheme  Based on HW (6 or so)    Chapter 1  We deal with rotating and stratified fluids  Rotating: spinning around an axis Statified: a gradient in the density exists (light density higher, heavier density lower)   Dealing with large scale motion of fluid (can ignore convection effects)  ocean basins continental US    Material Derivative (Lagrangian Derivative)  $\\frac{D}{\\cancel{D}t} = \\frac{\\partial}{\\partial t}+ \\vec{v}\\cdot \\nabla = \\frac{\\partial}{\\partial t}+v_{x}\\frac{\\partial}{\\partial x}+v_{y}\\frac{\\partial}{\\partial y}+v_{z}\\frac{\\partial}{\\partial z}$  The first part is the Eulerian deriviative (local change) The second part is the nonlinear term (ie. the good stuff) $v = \\vec{v}(x,y,z,t)$    Conservation of Mass  $\\frac{D}{\\cancel{D}t}\\rho+\\rho \\nabla\\cdot\\vec{v} = 0$  $\\rho = \\rho(x,y,z,t)$ $\\frac{\\partial \\rho}{\\partial t}+\\nabla \\cdot (\\rho \\vec{v}) = 0$    Momentum Equation  $\\frac{\\partial \\vec{v}}{\\partial t}+(\\vec{v}\\cdot\\nabla)\\vec{v} = \\frac{-1}{\\rho}\\nabla P + \\nu \\nabla^{2}\\vec{v}+F_{b}$  $\\rho$ is pressure, $P$ is pressure, $\\mu$ is the friction coefficient First term: pressure term Second term: friction term Third term: “body” forces (most common forces: gravity, EM forces) Newton Law analogy: $\\vec{a}=\\frac{\\vec{F}}{m}$ (ie the every term is a force per unit mass)   Ex: Consider an inviscid (non viscous) fluid ($\\nu=0$) at rest ($\\vec{v}=0$) with gravity ($F_{b} = -g\\hat{k}$)  LHS=0. 2nd term on RHS is zero. Spliting into components  $\\frac{\\partial \\rho}{\\partial x}=0$ $\\frac{\\partial \\rho}{\\partial y}=0$ $\\frac{\\partial \\rho}{\\partial z} = -\\rho g \\rightarrow p(z) = -\\int_{z}^{TOA}\\rho g\\ dz$  $\\rho = \\rho(z)$ and $g = g(z)$ (normally a constant) $TOA$ is the top of atmosphere where pressure falls to basically zero        Equation of State  So far, we have 4 equations and 5 unknowns ($\\rho,P$ and 3 components of $\\vec{v}$) Need to connect $\\rho$ to $P$ with an equation of state Can also use a conservation law (ie. conservation of energy)  Sound Waves  Longitudinal Pressure and density waves Take conservation of mass and momentum equations and linearize them (Let $\\vec{v}=\\vec{v_{0}+\\vec{v}^{'}} $ and $\\rho_{0}+\\rho^{'}$, then multiply out, and drop all the quadratic terms):  $\\frac{D\\rho}{\\cancel{D}t}+\\rho\\nabla\\vec{v}=0\\rightarrow\\frac{\\partial \\rho^{'}}{\\partial t}+\\rho_{0}\\nabla\\cdot\\vec{v^{'}} = 0$ $\\frac{D\\vec{v}}{\\cancel{D}t} = \\frac{-\\nabla P}{\\rho}\\rightarrow \\frac{\\partial \\vec{v}}{\\partial t} = \\frac{-\\nabla P}{\\rho}$ From thermodynamics, we know for an ideal gas that $P = c\\rho^{\\gamma}$. We linearize like the other equations, and then make the approximation $(1+\\frac{\\rho^{'}}{\\rho_{0}})^{\\gamma}\\approx 1+\\gamma(\\frac{\\rho^{'}}{\\rho_{0}})$ and recall $P_{0}= C\\rho_{0}^{\\gamma}$ to get that:  $P{'} = \\gamma\\frac{\\rho_{0}}{P_{0}}\\rho^{'} = (\\gamma RT_{0})\\rho^{'}$   Can take partials w.r.t time and replace $\\rho^{'}$ with $P^{'}$ and eventually, you get a wave equation:  $\\frac{\\partial^{2}P^{'}}{\\partial t^{2}} = c_{s}^{2}\\nabla^{2}P^{'}$ where $c_{s}^{2} = \\gamma RT$ is the speed of sound      Chapter 2 Why a rotating frame?  We live on Earth. Earth rotates. We should use a rotating frame to describe the Navier Stokes equations By translating to a rotating frame, we remove the “solid body” rotation   We have the Earth with a thin layer of fluid on its surface. It rotates around the z axis. The atmosphere gets “dragged” along by the Earth (the solid body) and rotates together with the Earth at a rate of $2\\pi$ per day up down velocity (vertical) is zero ($w=0$) North South velocity is zero ($v=0$) East West velocity is only a function of latitude $\\theta$ (ie. $u=u(\\theta)$)  Radius of Earth is 6400 km. So $u(\\theta=0) = 465 \\frac{m}{s}$. This is typically orders of magnitude larger than any relevant phenomena      Derivation of Velocity and Acceleration in Rotating Frames  Consider a constant length vector $\\vec{v}$ (originating from the origin) rotating around an axis $\\vec{\\Omega}$. Longitude in xy plane denoted by $\\lambda$ and latitude denoted by $\\theta$. We can always choose $\\vec{\\Omega}$ to lie along the z-axis.  $(\\frac{d\\vec{v}}{dt})_{I} = \\Omega \\times \\vec{v}$  rate of change of $\\vec{v}$ in the inertial frame     consider a vector $\\vec{B}$ that varies in time  $\\frac{d\\vec{B_{I}}}{dt} = \\frac{d\\vec{B_{r}}}{dt}+ \\Omega\\times\\vec{B}$ Ie. The inertial change over time is related to the rotating change over time with the addition of the rotation velocity This applies to the position vector $\\vec{r}$ as well. We can interpret the time derivatives as velocities in their respective frames   Take the time derivative of the velocity terms. The time derivative formula above still holds for the velocity vectors (use $\\vec{v_{I}}$ instead of $\\vec{r}$). You then replace all the inertial frame values with rotating frame values. You eventually get: $\\frac{d\\vec{v_{I}}}{dt^2} = \\frac{d\\vec{v_{r}}}{dt^2}+2\\Omega\\times\\vec{v}_{r}+\\Omega\\times(\\Omega\\times\\vec{r})$ $2\\Omega\\times\\vec{v_{r}}$ is the Coriolis force.  This does no work because it is orthogonal to the direction of motion   $\\Omega\\times(\\Omega\\times\\vec{r})$ is the centifugal force  It is a potential force (ie. only depends on position) $\\Omega\\times\\vec{r_{\\perp}} = \\Omega\\times\\vec{r}$ Recall the CAB-BAC rule:  $\\vec{A}\\times\\vec{B}\\times\\vec{C} = (\\vec{C}\\cdot\\vec{A})\\vec{B} -(\\vec{B}\\cdot\\vec{A})\\vec{C}$   The CAB-BAC rule can be used to simplify the Centrifugal force to $-\\Omega^{2}\\vec{r_{\\perp}} = -\\nabla \\Phi_{centrifugal}$, where $\\Phi_{centrifugal} = \\frac{\\Omega^{2}r^{2}}{2}$ We can redefine the potential such that we can ignore the centrifugal force    Fluid Equations in Rotating Frame  In the rotating frame, we find that  $\\frac{d\\vec{v}}{dt} = 2\\Omega\\times\\vec{v} = \\frac{-\\nabla P}{\\rho} -\\nabla \\Phi - \\nu \\nabla^{2}\\vec{v}$   The material derivative is unchanged when shifting frames  $\\frac{D\\rho_{R}}{\\cancel{D}t}=\\frac{D\\rho_{I}}{\\cancel{D}t} \\rightarrow \\frac{D}{\\cancel{D}t}\\rho +\\rho \\nabla \\cdot \\vec{v} = 0$  Time derivative is trivially unchanged. The $\\nabla\\cdot v$ term is zero when you expand out in terms of components     Conservation of Energy is $\\frac{D}{Dt}\\Eta = 0$ and $\\Eta = (\\frac{P}{P_{0}})^{\\kappa}$ are unchanged  Encoding The Spherical Earth in Equations   We draw a sphere and make the x,y,z projections  Define $\\lambda$ to be the longitude (east to west) that varies from 0 to $2\\pi$, $\\theta$ to be the latitude(north to south) that varies from $\\frac{-\\pi}{2}$ to $\\frac{\\pi}{2}$, and $r$ is the distance from the center of the earth The velocities can be written as $\\vec{v} = (u,v,w) = (r\\cos\\theta \\frac{D\\lambda}{\\cancel{D}t}, r\\frac{D\\theta}{\\cancel{D}t}, \\frac{Dr}{\\cancel{D}t}) = u\\hat{i}+v\\hat{j}+w\\hat{k}$ To find $\\frac{D\\vec{v}}{\\cancel{D}t}$, you have to remember that the basis vectors are no longer constant; they change with time.  $\\frac{D\\hat{i}}{\\cancel{D}t} = \\frac{u}{\\cos\\theta}(\\sin\\theta\\hat{j}-\\cos\\theta\\hat{k})$ $\\frac{D\\hat{j}}{\\cancel{D}t} = \\frac{-u}{r} \\tan\\theta \\hat{j}-\\frac{v}{r}\\hat{k}$ $\\frac{D\\hat{k}}{\\cancel{D}t} = \\frac{u}{r}\\hat{i}+\\frac{v}{r}\\hat{j}$     You get the spherical versions of the fluid equations with the above substitutions. Way to complicated. Practically, we need to approximate  Primitive Equations (Dynamical Core, because you can’t get rid of the air)  Some approximations we can make:  Let $r = z+a$, where a is the radius of the Earth and z is the position in the atmosphere (z« a). This means that $\\frac{1}{r} = \\frac{1}{a}$ and $\\frac{\\partial}{\\partial r} = \\frac{\\partial}{\\partial z}$  called the shallow fluid approximation   Assume that w « v and w « u  Kill all terms quadratic in velocities that involve w (metric terms) Kill the Coreolis terms involving w   Make the momentum equation in R hydrostatic (no dependency on time) Define $\\vec{v} = u+\\hat{i}+v\\hat{j}+w\\hat{k}$ and $\\vec{u} = u+\\hat{i}+v\\hat{j}$ (ie. we can ignore w term) We then get:  $\\frac{D\\vec{u}}{\\cancel{D}t}+\\vec{f}\\times\\vec{u} = \\frac{\\nabla_{z} P}{\\rho}$  $\\vec{f} = 2\\Omega\\sin\\theta\\hat{k}$ is called the Coriolis parameter   $\\frac{D\\vec{\\rho}}{\\cancel{D}t}+\\rho \\nabla \\cdot \\vec{v} = 0$ $\\frac{D\\Eta}{\\cancel{D}t} = 0$ $\\frac{\\partial p}{\\partial z}= -\\rho g$      What is $\\vec{f}$ physically  Recall that $(\\vec{v}\\cdot \\nabla)\\vec{v} = (\\nabla\\times\\vec{v})\\times\\vec{v}+\\frac{1}{2}\\nabla|\\vec{v}|^{2}$  Define $\\nabla\\times\\vec{v}=\\omega$ as the vorticity of the flow (or the relative vorticity)   Plug this into the momentum equation shows you that we can interpret $\\vec{f}$ as a vorticity (planetary vorticity) because it gets added to $\\omega$ We define $\\vec{\\zeta}$ as the Vorticity in the direction orthogonal to the surface of the Earth (ie $\\vec{\\zeta} = \\vec{\\omega}\\cdot\\hat{k}$)  Stratification Boussinesq Equation  Key Idea: Density variation due to fluid motions are small compared to the mean density. Hence, density variations only affect fluid motion when coupled with gravity let $\\rho(x,y,z,t) = \\rho_{0}+\\delta\\rho(x,y,z,t)$ where $\\delta\\rho$ is the varying part of the density  Make the assumption that $\\frac{\\delta \\rho}{\\rho_{0}} \\ll 1$   Define a pressure field that is in hydrostatic balance with $\\rho_{0}$  $p = p_{0}+\\delta p(x,y,z,t)$ $\\frac{dp_{0}}{dz} = -\\rho_{0}g$ (variation in pressure due to constant density)   From the momentum equation, linearize w.r.t. $\\rho$ and $p$ using the above equations  Assume that $\\nabla\\Phi_{g} = -g\\hat{k}$   Throw away $\\delta \\rho$ on the LHS since it is small compared to $\\rho_{0}$ Defining $b = -g\\frac{\\delta\\rho}{\\rho}$ and $\\frac{\\delta P}{\\rho_{0}} = \\phi$ yields that  $\\frac{D\\vec{v}}{\\cancel{D}t}+2 \\Omega \\times \\vec{v} = -\\nabla\\phi+b$ $\\phi$ is the pressure variation b is buoyancy = density variation   You can do a similar process with the continuity equation and only keep first order terms to yield  $\\nabla\\cdot\\vec{v} = 0$ or physically, your fluid is incompressible   Going back to thermodynamics, recall that  $\\frac{D\\rho}{\\cancel{D}t}-\\frac{1}{c-{s}^{2}}\\frac{Dp}{\\cancel{D}t} = DiabaticTerms$  the speed of propagation is $c_{s}$, which is given by $c_{s}^{2} = \\frac{\\partial P}{\\partial \\rho}_{\\eta}$ where $\\eta$ is the entropy Let the speed of propagation $c_{s}\\rightarrow \\infty$, take derivate of the constant term $\\rho_{0}$ and multiply and divide by some constants to yield  $\\frac{Db}{\\cancel{D}t} = \\dot{b}$     5 equations (3 from momentum, 1 incompressible equation, 1 thermo) and 5 unknowns ($u,v,w,\\phi,b$)    Anelastic Equations  Assume that $\\theta = \\tilde{\\theta}+\\delta\\theta$ and that $b_{a} = g\\frac{\\delta\\theta}{\\theta}$ Linearize w.r.t. to $\\rho$ and $p$ and assume hydrostatic relation $\\frac{\\partial \\tilde{P}}{\\partial z} = -\\tilde{\\rho}(z)g$. (~ denotes the constant term). We make the assumption that $\\delta\\theta \\ll \\theta$, which is a bad approximation for the atmosphere (but good for astrophysical fluids) Chugging through yields  $\\frac{D\\vec{v}}{\\cancel{D}t} + 2\\Omega\\times\\vec{v} = -\\nabla\\Phi +b_{a}\\hat{k}$ $\\frac{Db_{a}}{\\cancel{D}t} = \\dot{b_{a}}$ $\\nabla(\\tilde{\\rho}\\vec{v}) = 0$    Alternative Vertical Coordinates  Let $\\xi$ denote whatever your vertical coordinate is (pressure, log pressure, z, $\\theta$ etc.) We can rewrite $z = z(x,y,\\xi,t)$ Let $Q = Q(x,y,z,t)$ $(\\frac{\\partial Q}{\\partial x})_{\\xi}$ can be replaced with  $(\\frac{\\partial Q}{\\partial x})_{z}$ added to $\\frac{\\partial Q}{\\partial z}(\\frac{\\partial z}{\\partial x})_{\\xi}$   Going back to the primitive equations, if you let $Q=\\xi=P$, you can replace z with $P$. This simplifies the equation, but the cost is that the boundary conditions are no longer straight forward  ",
  "wordCount" : "1647",
  "inLanguage": "en",
  "datePublished": "2023-01-17T22:19:05-05:00",
  "dateModified": "2023-02-08T10:45:09-05:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://mushetty.me/notes/geophysics/geophysics/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "mushetty.me",
    "logo": {
      "@type": "ImageObject",
      "url": "https://mushetty.me/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://mushetty.me" accesskey="h" title="mushetty.me (Alt + H)">mushetty.me</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://mushetty.me/simulations/" title="Simulations">
                    <span>Simulations</span>
                </a>
            </li>
            <li>
                <a href="https://mushetty.me/notes/" title="Notes">
                    <span>Notes</span>
                </a>
            </li>
            <li>
                <a href="https://mushetty.me/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Geophysical Fluid Dynamics (GFD)
    </h1>
    <div class="post-meta"><span title='2023-01-17 22:19:05 -0500 EST'>Date Created: January 17, 2023</span>&nbsp;·&nbsp;<span title='2023-02-08 10:45:09 -0500 EST'>Last Modified: February 8, 2023</span>

</div>
  </header> 
  <div class="post-content"><p>Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.</p>
<ul>
<li><a href="#administrative-stuff">Administrative Stuff</a></li>
<li><a href="#chapter-1">Chapter 1</a>
<ul>
<li><a href="#material-derivative-lagrangian-derivative">Material Derivative (Lagrangian Derivative)</a></li>
<li><a href="#conservation-of-mass">Conservation of Mass</a></li>
<li><a href="#momentum-equation">Momentum Equation</a></li>
<li><a href="#equation-of-state">Equation of State</a></li>
<li><a href="#sound-waves">Sound Waves</a></li>
</ul>
</li>
<li><a href="#chapter-2">Chapter 2</a>
<ul>
<li><a href="#why-a-rotating-frame">Why a rotating frame?</a></li>
<li><a href="#derivation-of-velocity-and-acceleration-in-rotating-frames">Derivation of Velocity and Acceleration in Rotating Frames</a></li>
<li><a href="#fluid-equations-in-rotating-frame">Fluid Equations in Rotating Frame</a>
<ul>
<li><a href="#encoding-the-spherical-earth-in-equations">Encoding The Spherical Earth in Equations</a></li>
<li><a href="#primitive-equations-dynamical-core-because-you-cant-get-rid-of-the-air">Primitive Equations (Dynamical Core, because you can&rsquo;t get rid of the air)</a>
<ul>
<li><a href="#what-is-vecf-physically">What is $\vec{f}$ physically</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#stratification">Stratification</a>
<ul>
<li><a href="#boussinesq-equation">Boussinesq Equation</a></li>
<li><a href="#anelastic-equations">Anelastic Equations</a></li>
</ul>
</li>
<li><a href="#alternative-vertical-coordinates">Alternative Vertical Coordinates</a></li>
</ul>
</li>
</ul>
<h2 id="administrative-stuff">Administrative Stuff<a hidden class="anchor" aria-hidden="true" href="#administrative-stuff">#</a></h2>
<ul>
<li>Office Hours: Engineering Terrace 287 on Thursdays during class time (4:00-5:00 PM)</li>
<li>TA: Eojin Lee el3080[at]columbia.edu</li>
<li>Primary Textbook: Geoff Vallis: Atmospheric and Oceanic Fluid Dynamics 1st Edition (pdf available on Columbia Library)
<ul>
<li>Course covers Ch 1-6. Maybe Ch 8.</li>
</ul>
</li>
<li>Other texts:
<ul>
<li>J. Pedlosky: GFD</li>
<li>Adrian Gill: Atmosphere Ocean Dynamics</li>
<li>More Specialized
<ul>
<li>Rich Salmon</li>
<li>Jim McWilliams</li>
<li>Benoit Cushman-Roisin</li>
</ul>
</li>
</ul>
</li>
<li>Grading Scheme
<ul>
<li>Based on HW (6 or so)</li>
</ul>
</li>
</ul>
<h2 id="chapter-1">Chapter 1<a hidden class="anchor" aria-hidden="true" href="#chapter-1">#</a></h2>
<ul>
<li>We deal with <strong>rotating</strong> and <strong>stratified</strong> fluids
<ul>
<li>Rotating: spinning around an axis</li>
<li>Statified: a gradient in the density exists (light density higher, heavier density lower)</li>
</ul>
</li>
<li>Dealing with large scale motion of fluid (can ignore convection effects)
<ul>
<li>ocean basins</li>
<li>continental US</li>
</ul>
</li>
</ul>
<h3 id="material-derivative-lagrangian-derivative">Material Derivative (Lagrangian Derivative)<a hidden class="anchor" aria-hidden="true" href="#material-derivative-lagrangian-derivative">#</a></h3>
<ul>
<li>$\frac{D}{\cancel{D}t} = \frac{\partial}{\partial t}+ \vec{v}\cdot \nabla = \frac{\partial}{\partial t}+v_{x}\frac{\partial}{\partial x}+v_{y}\frac{\partial}{\partial y}+v_{z}\frac{\partial}{\partial z}$
<ul>
<li>The first part is the Eulerian deriviative (local change)</li>
<li>The second part is the nonlinear term (ie. the good stuff)</li>
<li>$v = \vec{v}(x,y,z,t)$</li>
</ul>
</li>
</ul>
<h3 id="conservation-of-mass">Conservation of Mass<a hidden class="anchor" aria-hidden="true" href="#conservation-of-mass">#</a></h3>
<ul>
<li>$\frac{D}{\cancel{D}t}\rho+\rho \nabla\cdot\vec{v} = 0$
<ul>
<li>$\rho = \rho(x,y,z,t)$</li>
<li>$\frac{\partial \rho}{\partial t}+\nabla \cdot (\rho \vec{v}) = 0$</li>
</ul>
</li>
</ul>
<h3 id="momentum-equation">Momentum Equation<a hidden class="anchor" aria-hidden="true" href="#momentum-equation">#</a></h3>
<ul>
<li>$\frac{\partial \vec{v}}{\partial t}+(\vec{v}\cdot\nabla)\vec{v} = \frac{-1}{\rho}\nabla P + \nu \nabla^{2}\vec{v}+F_{b}$
<ul>
<li>$\rho$ is pressure, $P$ is pressure, $\mu$ is the friction coefficient</li>
<li>First term: pressure term</li>
<li>Second term: friction term</li>
<li>Third term: &ldquo;body&rdquo; forces (most common forces: gravity, EM forces)</li>
<li>Newton Law analogy: $\vec{a}=\frac{\vec{F}}{m}$ (ie the every term is a force per unit mass)</li>
</ul>
</li>
<li>Ex: Consider an inviscid (non viscous) fluid ($\nu=0$) at rest  ($\vec{v}=0$) with gravity ($F_{b} = -g\hat{k}$)
<ul>
<li>LHS=0. 2nd term on RHS is zero. Spliting into components
<ul>
<li>$\frac{\partial \rho}{\partial x}=0$</li>
<li>$\frac{\partial \rho}{\partial y}=0$</li>
<li>$\frac{\partial \rho}{\partial z} = -\rho g \rightarrow p(z) = -\int_{z}^{TOA}\rho g\ dz$
<ul>
<li>$\rho = \rho(z)$ and $g = g(z)$ (normally a constant)</li>
<li>$TOA$ is the top of atmosphere where pressure falls to basically zero</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="equation-of-state">Equation of State<a hidden class="anchor" aria-hidden="true" href="#equation-of-state">#</a></h3>
<ul>
<li>So far, we have 4 equations and 5 unknowns ($\rho,P$ and 3 components of $\vec{v}$)</li>
<li>Need to connect $\rho$ to $P$ with an equation of state</li>
<li>Can also use a conservation law (ie. conservation of energy)</li>
</ul>
<h3 id="sound-waves">Sound Waves<a hidden class="anchor" aria-hidden="true" href="#sound-waves">#</a></h3>
<ul>
<li>Longitudinal Pressure and density waves</li>
<li>Take conservation of mass and momentum equations and linearize them (Let $\vec{v}=\vec{v_{0}+\vec{v}^{'}} $ and $\rho_{0}+\rho^{'}$, then multiply out, and drop all the quadratic terms):
<ul>
<li>$\frac{D\rho}{\cancel{D}t}+\rho\nabla\vec{v}=0\rightarrow\frac{\partial \rho^{'}}{\partial t}+\rho_{0}\nabla\cdot\vec{v^{'}} = 0$</li>
<li>$\frac{D\vec{v}}{\cancel{D}t} = \frac{-\nabla P}{\rho}\rightarrow \frac{\partial \vec{v}}{\partial t} = \frac{-\nabla P}{\rho}$</li>
<li>From thermodynamics, we know for an ideal gas that $P = c\rho^{\gamma}$. We linearize like the other equations, and then make the approximation $(1+\frac{\rho^{'}}{\rho_{0}})^{\gamma}\approx 1+\gamma(\frac{\rho^{'}}{\rho_{0}})$ and recall $P_{0}= C\rho_{0}^{\gamma}$ to get that:
<ul>
<li>$P{'} = \gamma\frac{\rho_{0}}{P_{0}}\rho^{'} = (\gamma RT_{0})\rho^{'}$</li>
</ul>
</li>
<li>Can take partials w.r.t time and replace $\rho^{'}$ with $P^{'}$ and eventually, you get a wave equation:
<ul>
<li>$\frac{\partial^{2}P^{'}}{\partial t^{2}} = c_{s}^{2}\nabla^{2}P^{'}$ where $c_{s}^{2} = \gamma RT$ is the speed of sound</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="chapter-2">Chapter 2<a hidden class="anchor" aria-hidden="true" href="#chapter-2">#</a></h2>
<h3 id="why-a-rotating-frame">Why a rotating frame?<a hidden class="anchor" aria-hidden="true" href="#why-a-rotating-frame">#</a></h3>
<ul>
<li>We live on Earth. Earth rotates. We should use a rotating frame to describe the Navier Stokes equations</li>
<li>By translating to a rotating frame, we remove the &ldquo;solid body&rdquo; rotation
<ul>
<li><img loading="lazy" src="/images/Geo/GFDSolidRotation.png" alt="FluidOnSphere"  />
</li>
<li>We have the Earth with a thin layer of fluid on its surface. It rotates around the z axis. The atmosphere gets &ldquo;dragged&rdquo; along by the Earth (the solid body) and rotates together with the Earth at a rate of $2\pi$ per day</li>
<li>up down velocity (vertical) is zero ($w=0$)</li>
<li>North South velocity is zero ($v=0$)</li>
<li>East West velocity is only a function of latitude $\theta$ (ie. $u=u(\theta)$)
<ul>
<li>Radius of Earth is 6400 km. So $u(\theta=0) = 465 \frac{m}{s}$. This is typically orders of magnitude larger than any relevant phenomena</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="derivation-of-velocity-and-acceleration-in-rotating-frames">Derivation of Velocity and Acceleration in Rotating Frames<a hidden class="anchor" aria-hidden="true" href="#derivation-of-velocity-and-acceleration-in-rotating-frames">#</a></h3>
<p><img loading="lazy" src="/static/images/Geo/RotatingVector.png" alt="RotatingVector"  />
</p>
<ul>
<li>Consider a constant length vector $\vec{v}$ (originating from the origin) rotating around an axis $\vec{\Omega}$. Longitude in xy plane denoted by $\lambda$ and latitude denoted by $\theta$. We can always choose $\vec{\Omega}$ to lie along the z-axis.
<ul>
<li>$(\frac{d\vec{v}}{dt})_{I} = \Omega \times \vec{v}$
<ul>
<li>rate of change of $\vec{v}$ in the inertial frame</li>
</ul>
</li>
</ul>
</li>
<li>consider a vector $\vec{B}$ that varies in time
<ul>
<li>$\frac{d\vec{B_{I}}}{dt} = \frac{d\vec{B_{r}}}{dt}+ \Omega\times\vec{B}$</li>
<li>Ie. The inertial change over time is related to the rotating change over time with the addition of the rotation velocity</li>
<li>This applies to the position vector $\vec{r}$ as well. We can interpret the time derivatives as velocities in their respective frames</li>
</ul>
</li>
<li>Take the time derivative of the velocity terms. The time derivative formula above still holds for the velocity vectors (use $\vec{v_{I}}$ instead of $\vec{r}$). You then replace all the inertial frame values with rotating frame values. You eventually get:</li>
<li>$\frac{d\vec{v_{I}}}{dt^2} = \frac{d\vec{v_{r}}}{dt^2}+2\Omega\times\vec{v}_{r}+\Omega\times(\Omega\times\vec{r})$</li>
<li>$2\Omega\times\vec{v_{r}}$ is the Coriolis force.
<ul>
<li>This does no work because it is orthogonal to the direction of motion</li>
</ul>
</li>
<li>$\Omega\times(\Omega\times\vec{r})$ is the centifugal force
<ul>
<li>It is a potential force (ie. only depends on position)</li>
<li>$\Omega\times\vec{r_{\perp}} = \Omega\times\vec{r}$</li>
<li>Recall the CAB-BAC rule:
<ul>
<li>$\vec{A}\times\vec{B}\times\vec{C} = (\vec{C}\cdot\vec{A})\vec{B} -(\vec{B}\cdot\vec{A})\vec{C}$</li>
</ul>
</li>
<li>The CAB-BAC rule can be used to simplify the Centrifugal force to $-\Omega^{2}\vec{r_{\perp}} = -\nabla \Phi_{centrifugal}$, where $\Phi_{centrifugal} = \frac{\Omega^{2}r^{2}}{2}$</li>
<li>We can redefine the potential such that we can ignore the centrifugal force</li>
</ul>
</li>
</ul>
<h3 id="fluid-equations-in-rotating-frame">Fluid Equations in Rotating Frame<a hidden class="anchor" aria-hidden="true" href="#fluid-equations-in-rotating-frame">#</a></h3>
<ul>
<li>In the rotating frame, we find that
<ul>
<li>$\frac{d\vec{v}}{dt} = 2\Omega\times\vec{v} = \frac{-\nabla P}{\rho} -\nabla \Phi - \nu \nabla^{2}\vec{v}$</li>
</ul>
</li>
<li>The material derivative is unchanged when shifting frames
<ul>
<li>$\frac{D\rho_{R}}{\cancel{D}t}=\frac{D\rho_{I}}{\cancel{D}t} \rightarrow \frac{D}{\cancel{D}t}\rho +\rho \nabla \cdot \vec{v} = 0$
<ul>
<li>Time derivative is trivially unchanged. The $\nabla\cdot v$ term is zero when you expand out in terms of components</li>
</ul>
</li>
</ul>
</li>
<li>Conservation of Energy is $\frac{D}{Dt}\Eta = 0$ and $\Eta = (\frac{P}{P_{0}})^{\kappa}$ are unchanged</li>
</ul>
<h4 id="encoding-the-spherical-earth-in-equations">Encoding The Spherical Earth in Equations<a hidden class="anchor" aria-hidden="true" href="#encoding-the-spherical-earth-in-equations">#</a></h4>
<ul>
<li><img loading="lazy" src="/images/Geo/GeoSphericalCoordinates.png" alt="GeoSphericalCoordinates"  />
</li>
<li>We draw a sphere and make the x,y,z projections
<ul>
<li>Define $\lambda$ to be the longitude (east to west) that varies from 0 to $2\pi$, $\theta$ to be the latitude(north to south) that varies from $\frac{-\pi}{2}$ to $\frac{\pi}{2}$, and $r$ is the distance from the center of the earth</li>
<li>The velocities can be written as $\vec{v} = (u,v,w) = (r\cos\theta \frac{D\lambda}{\cancel{D}t}, r\frac{D\theta}{\cancel{D}t}, \frac{Dr}{\cancel{D}t}) = u\hat{i}+v\hat{j}+w\hat{k}$</li>
<li>To find $\frac{D\vec{v}}{\cancel{D}t}$, you have to remember that the basis vectors are no longer constant; they change with time.
<ul>
<li>$\frac{D\hat{i}}{\cancel{D}t} = \frac{u}{\cos\theta}(\sin\theta\hat{j}-\cos\theta\hat{k})$</li>
<li>$\frac{D\hat{j}}{\cancel{D}t} = \frac{-u}{r} \tan\theta \hat{j}-\frac{v}{r}\hat{k}$</li>
<li>$\frac{D\hat{k}}{\cancel{D}t} = \frac{u}{r}\hat{i}+\frac{v}{r}\hat{j}$</li>
</ul>
</li>
</ul>
</li>
<li>You get the spherical versions of the fluid equations with the above substitutions. Way to complicated. Practically, we need to approximate</li>
</ul>
<h4 id="primitive-equations-dynamical-core-because-you-cant-get-rid-of-the-air">Primitive Equations (Dynamical Core, because you can&rsquo;t get rid of the air)<a hidden class="anchor" aria-hidden="true" href="#primitive-equations-dynamical-core-because-you-cant-get-rid-of-the-air">#</a></h4>
<ul>
<li>Some approximations we can make:
<ul>
<li>Let $r = z+a$, where a is the radius of the Earth and z is the position in the atmosphere (z&laquo; a). This means that $\frac{1}{r} = \frac{1}{a}$ and $\frac{\partial}{\partial r} = \frac{\partial}{\partial z}$
<ul>
<li>called the shallow fluid approximation</li>
</ul>
</li>
<li>Assume that w &laquo; v and w &laquo; u
<ul>
<li>Kill all terms quadratic in velocities that involve w (metric terms)</li>
<li>Kill the Coreolis terms involving w</li>
</ul>
</li>
<li>Make the momentum equation in R hydrostatic (no dependency on time)</li>
<li>Define $\vec{v} = u+\hat{i}+v\hat{j}+w\hat{k}$ and $\vec{u} = u+\hat{i}+v\hat{j}$ (ie. we can ignore w term)</li>
<li>We then get:
<ul>
<li>$\frac{D\vec{u}}{\cancel{D}t}+\vec{f}\times\vec{u} = \frac{\nabla_{z} P}{\rho}$
<ul>
<li>$\vec{f} = 2\Omega\sin\theta\hat{k}$ is called the Coriolis parameter</li>
</ul>
</li>
<li>$\frac{D\vec{\rho}}{\cancel{D}t}+\rho \nabla \cdot \vec{v} = 0$</li>
<li>$\frac{D\Eta}{\cancel{D}t} = 0$</li>
<li>$\frac{\partial p}{\partial z}= -\rho g$</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="what-is-vecf-physically">What is $\vec{f}$ physically<a hidden class="anchor" aria-hidden="true" href="#what-is-vecf-physically">#</a></h5>
<ul>
<li>Recall that $(\vec{v}\cdot \nabla)\vec{v} = (\nabla\times\vec{v})\times\vec{v}+\frac{1}{2}\nabla|\vec{v}|^{2}$
<ul>
<li>Define $\nabla\times\vec{v}=\omega$ as the vorticity of the flow (or the relative vorticity)</li>
</ul>
</li>
<li>Plug this into the momentum equation shows you that we can interpret $\vec{f}$ as a vorticity (planetary vorticity) because it gets added to $\omega$</li>
<li>We define $\vec{\zeta}$ as the Vorticity in the direction orthogonal to the surface of the Earth (ie $\vec{\zeta} = \vec{\omega}\cdot\hat{k}$)</li>
</ul>
<h3 id="stratification">Stratification<a hidden class="anchor" aria-hidden="true" href="#stratification">#</a></h3>
<h4 id="boussinesq-equation">Boussinesq Equation<a hidden class="anchor" aria-hidden="true" href="#boussinesq-equation">#</a></h4>
<ul>
<li>Key Idea: Density variation due to fluid motions are small compared to the mean density. Hence, density variations only affect fluid motion when coupled with gravity</li>
<li>let $\rho(x,y,z,t) = \rho_{0}+\delta\rho(x,y,z,t)$ where $\delta\rho$ is the varying part of the density
<ul>
<li>Make the assumption that $\frac{\delta \rho}{\rho_{0}} \ll 1$</li>
</ul>
</li>
<li>Define a pressure field that is in hydrostatic balance with $\rho_{0}$
<ul>
<li>$p = p_{0}+\delta p(x,y,z,t)$</li>
<li>$\frac{dp_{0}}{dz} = -\rho_{0}g$ (variation in pressure due to constant density)</li>
</ul>
</li>
<li>From the momentum equation, linearize w.r.t. $\rho$ and $p$ using the above equations
<ul>
<li>Assume that $\nabla\Phi_{g} = -g\hat{k}$</li>
</ul>
</li>
<li>Throw away $\delta \rho$ on the LHS since it is small compared to $\rho_{0}$</li>
<li>Defining $b = -g\frac{\delta\rho}{\rho}$ and $\frac{\delta P}{\rho_{0}} = \phi$ yields that
<ul>
<li>$\frac{D\vec{v}}{\cancel{D}t}+2 \Omega \times \vec{v} = -\nabla\phi+b$</li>
<li>$\phi$ is the pressure variation</li>
<li>b is buoyancy = density variation</li>
</ul>
</li>
<li>You can do a similar process with the continuity equation and only keep first order terms to yield
<ul>
<li>$\nabla\cdot\vec{v} = 0$</li>
<li>or physically, your fluid is incompressible</li>
</ul>
</li>
<li>Going back to thermodynamics, recall that
<ul>
<li>$\frac{D\rho}{\cancel{D}t}-\frac{1}{c-{s}^{2}}\frac{Dp}{\cancel{D}t} = DiabaticTerms$
<ul>
<li>the speed of propagation is $c_{s}$, which is given by $c_{s}^{2} = \frac{\partial P}{\partial \rho}_{\eta}$ where $\eta$ is the entropy</li>
<li>Let the speed of propagation $c_{s}\rightarrow \infty$, take derivate of the constant term $\rho_{0}$ and multiply and divide by some constants to yield
<ul>
<li>$\frac{Db}{\cancel{D}t} = \dot{b}$</li>
</ul>
</li>
</ul>
</li>
<li>5 equations (3 from momentum, 1 incompressible equation, 1 thermo) and 5 unknowns ($u,v,w,\phi,b$)</li>
</ul>
</li>
</ul>
<h4 id="anelastic-equations">Anelastic Equations<a hidden class="anchor" aria-hidden="true" href="#anelastic-equations">#</a></h4>
<ul>
<li>Assume that $\theta = \tilde{\theta}+\delta\theta$ and that $b_{a} = g\frac{\delta\theta}{\theta}$</li>
<li>Linearize w.r.t. to $\rho$ and $p$ and assume hydrostatic relation $\frac{\partial \tilde{P}}{\partial z} = -\tilde{\rho}(z)g$. (~ denotes the constant term).</li>
<li>We make the assumption that $\delta\theta \ll \theta$, which is a bad approximation for the atmosphere (but good for astrophysical fluids)</li>
<li>Chugging through yields
<ul>
<li>$\frac{D\vec{v}}{\cancel{D}t} + 2\Omega\times\vec{v} = -\nabla\Phi +b_{a}\hat{k}$</li>
<li>$\frac{Db_{a}}{\cancel{D}t} = \dot{b_{a}}$</li>
<li>$\nabla(\tilde{\rho}\vec{v}) = 0$</li>
</ul>
</li>
</ul>
<h3 id="alternative-vertical-coordinates">Alternative Vertical Coordinates<a hidden class="anchor" aria-hidden="true" href="#alternative-vertical-coordinates">#</a></h3>
<ul>
<li>Let $\xi$ denote whatever your vertical coordinate is (pressure, log pressure, z, $\theta$ etc.)</li>
<li>We can rewrite $z = z(x,y,\xi,t)$</li>
<li>Let $Q = Q(x,y,z,t)$</li>
<li>$(\frac{\partial Q}{\partial x})_{\xi}$ can be replaced with
<ul>
<li>$(\frac{\partial Q}{\partial x})_{z}$ added to</li>
<li>$\frac{\partial Q}{\partial z}(\frac{\partial z}{\partial x})_{\xi}$</li>
</ul>
</li>
<li>Going back to the primitive equations, if you let $Q=\xi=P$, you can replace z with $P$. This simplifies the equation, but the cost is that the boundary conditions are no longer straight forward</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://mushetty.me">mushetty.me</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
