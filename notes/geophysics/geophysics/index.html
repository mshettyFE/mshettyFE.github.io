<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Geophysical Fluid Dynamics (GFD) | mushetty.me</title>
<meta name="keywords" content="">
<meta name="description" content="Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.
 Administrative Stuff Chapter 1  Material Derivative (Lagrangian Derivative) Conservation of Mass Momentum Equation Equation of State Sound Waves   Chapter 2  Why a rotating frame? Derivation of Velocity and Acceleration in Rotating Frames Fluid Equations in Rotating Frame  Encoding The Spherical Earth in Equations Primitive Equations (Dynamical Core, because you can&rsquo;t get rid of the air)  What is $\vec{f}$ physically     Stratification  Boussinesq Equation Anelastic Equations   Alternative Vertical Coordinates Under What Conditions does Hydrostatic Balance Holds?">
<meta name="author" content="">
<link rel="canonical" href="https://mushetty.me/notes/geophysics/geophysics/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a5456a2fb6485e28d3190c101c9f7fea21d7eddeb7cf1b8dddf20aeb314df0cf.css" integrity="sha256-pUVqL7ZIXijTGQwQHJ9/6iHX7d63zxuN3fIK6zFN8M8=" rel="preload stylesheet" as="style">
<link rel="stylesheet" href="" />
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://mushetty.me/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://mushetty.me/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://mushetty.me/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://mushetty.me/apple-touch-icon.png">
<link rel="mask-icon" href="https://mushetty.me/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>


<meta property="og:title" content="Geophysical Fluid Dynamics (GFD)" />
<meta property="og:description" content="Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.
 Administrative Stuff Chapter 1  Material Derivative (Lagrangian Derivative) Conservation of Mass Momentum Equation Equation of State Sound Waves   Chapter 2  Why a rotating frame? Derivation of Velocity and Acceleration in Rotating Frames Fluid Equations in Rotating Frame  Encoding The Spherical Earth in Equations Primitive Equations (Dynamical Core, because you can&rsquo;t get rid of the air)  What is $\vec{f}$ physically     Stratification  Boussinesq Equation Anelastic Equations   Alternative Vertical Coordinates Under What Conditions does Hydrostatic Balance Holds?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mushetty.me/notes/geophysics/geophysics/" /><meta property="article:section" content="notes" />
<meta property="article:published_time" content="2023-01-17T22:19:05-05:00" />
<meta property="article:modified_time" content="2023-03-13T12:25:21-04:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Geophysical Fluid Dynamics (GFD)"/>
<meta name="twitter:description" content="Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.
 Administrative Stuff Chapter 1  Material Derivative (Lagrangian Derivative) Conservation of Mass Momentum Equation Equation of State Sound Waves   Chapter 2  Why a rotating frame? Derivation of Velocity and Acceleration in Rotating Frames Fluid Equations in Rotating Frame  Encoding The Spherical Earth in Equations Primitive Equations (Dynamical Core, because you can&rsquo;t get rid of the air)  What is $\vec{f}$ physically     Stratification  Boussinesq Equation Anelastic Equations   Alternative Vertical Coordinates Under What Conditions does Hydrostatic Balance Holds?"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Geophysical Fluid Dynamics (GFD)",
      "item": "https://mushetty.me/notes/geophysics/geophysics/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Geophysical Fluid Dynamics (GFD)",
  "name": "Geophysical Fluid Dynamics (GFD)",
  "description": "Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.\n Administrative Stuff Chapter 1  Material Derivative (Lagrangian Derivative) Conservation of Mass Momentum Equation Equation of State Sound Waves   Chapter 2  Why a rotating frame? Derivation of Velocity and Acceleration in Rotating Frames Fluid Equations in Rotating Frame  Encoding The Spherical Earth in Equations Primitive Equations (Dynamical Core, because you can\u0026rsquo;t get rid of the air)  What is $\\vec{f}$ physically     Stratification  Boussinesq Equation Anelastic Equations   Alternative Vertical Coordinates Under What Conditions does Hydrostatic Balance Holds?",
  "keywords": [
    
  ],
  "articleBody": "Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.\n Administrative Stuff Chapter 1  Material Derivative (Lagrangian Derivative) Conservation of Mass Momentum Equation Equation of State Sound Waves   Chapter 2  Why a rotating frame? Derivation of Velocity and Acceleration in Rotating Frames Fluid Equations in Rotating Frame  Encoding The Spherical Earth in Equations Primitive Equations (Dynamical Core, because you can’t get rid of the air)  What is $\\vec{f}$ physically     Stratification  Boussinesq Equation Anelastic Equations   Alternative Vertical Coordinates Under What Conditions does Hydrostatic Balance Holds?  Without Rotation  Adding Stratification   With Rotation Time scales Geostrophic flow Taylor-Proudman Theorem   Thermal Wind Balance Gravity Waves Shallow Water Theory  Gas Dynamics Connection Reduced Gravity Model   2 Layer Shallow Water    Administrative Stuff  Office Hours: Engineering Terrace 287 on Thursdays during class time (4:00-5:00 PM) TA: Eojin Lee el3080[at]columbia.edu Primary Textbook: Geoff Vallis: Atmospheric and Oceanic Fluid Dynamics 1st Edition (pdf available on Columbia Library)  Course covers Ch 1-6. Maybe Ch 8.   Other texts:  J. Pedlosky: GFD Adrian Gill: Atmosphere Ocean Dynamics More Specialized  Rich Salmon Jim McWilliams Benoit Cushman-Roisin     Grading Scheme  Based on HW (6 or so)    Chapter 1  We deal with rotating and stratified fluids  Rotating: spinning around an axis Statified: a gradient in the density exists (light density higher, heavier density lower)   Dealing with large scale motion of fluid (can ignore convection effects)  ocean basins continental US    Material Derivative (Lagrangian Derivative)  $\\frac{D}{\\cancel{D}t} = \\frac{\\partial}{\\partial t}+ \\vec{v}\\cdot \\nabla = \\frac{\\partial}{\\partial t}+v_{x}\\frac{\\partial}{\\partial x}+v_{y}\\frac{\\partial}{\\partial y}+v_{z}\\frac{\\partial}{\\partial z}$  The first part is the Eulerian deriviative (local change) The second part is the nonlinear term (ie. the good stuff) $v = \\vec{v}(x,y,z,t)$    Conservation of Mass  $\\frac{D}{\\cancel{D}t}\\rho+\\rho \\nabla\\cdot\\vec{v} = 0$  $\\rho = \\rho(x,y,z,t)$ $\\frac{\\partial \\rho}{\\partial t}+\\nabla \\cdot (\\rho \\vec{v}) = 0$    Momentum Equation  $\\frac{\\partial \\vec{v}}{\\partial t}+(\\vec{v}\\cdot\\nabla)\\vec{v} = \\frac{-1}{\\rho}\\nabla P + \\nu \\nabla^{2}\\vec{v}+F_{b}$  $\\rho$ is pressure, $P$ is pressure, $\\nu$ is the friction coefficient First term: pressure term Second term: friction term Third term: “body” forces (most common forces: gravity, EM forces) Newton Law analogy: $\\vec{a}=\\frac{\\vec{F}}{m}$ (ie the every term is a force per unit mass)   Ex: Consider an inviscid (non viscous) fluid ($\\nu=0$) at rest ($\\vec{v}=0$) with gravity ($F_{b} = -g\\hat{k}$)  LHS=0. 2nd term on RHS is zero. Spliting into components  $\\frac{\\partial \\rho}{\\partial x}=0$ $\\frac{\\partial \\rho}{\\partial y}=0$ $\\frac{\\partial \\rho}{\\partial z} = -\\rho g \\rightarrow p(z) = -\\int_{z}^{TOA}\\rho g\\ dz$  $\\rho = \\rho(z)$ and $g = g(z)$ (normally a constant) $TOA$ is the top of atmosphere where pressure falls to basically zero        Equation of State  So far, we have 4 equations and 5 unknowns ($\\rho,P$ and 3 components of $\\vec{v}$) Need to connect $\\rho$ to $P$ with an equation of state Can also use a conservation law (ie. conservation of energy)  Sound Waves  Longitudinal Pressure and density waves Take conservation of mass and momentum equations and linearize them (Let $\\vec{v}=\\vec{v_{0}+\\vec{v}^{'}} $ and $\\rho_{0}+\\rho^{'}$, then multiply out, and drop all the quadratic terms):  $\\frac{D\\rho}{\\cancel{D}t}+\\rho\\nabla\\vec{v}=0\\rightarrow\\frac{\\partial \\rho^{'}}{\\partial t}+\\rho_{0}\\nabla\\cdot\\vec{v^{'}} = 0$ $\\frac{D\\vec{v}}{\\cancel{D}t} = \\frac{-\\nabla P}{\\rho}\\rightarrow \\frac{\\partial \\vec{v}}{\\partial t} = \\frac{-\\nabla P}{\\rho}$ From thermodynamics, we know for an ideal gas that $P = c\\rho^{\\gamma}$. We linearize like the other equations, and then make the approximation $(1+\\frac{\\rho^{'}}{\\rho_{0}})^{\\gamma}\\approx 1+\\gamma(\\frac{\\rho^{'}}{\\rho_{0}})$ and recall $P_{0}= C\\rho_{0}^{\\gamma}$ to get that:  $P{'} = \\gamma\\frac{\\rho_{0}}{P_{0}}\\rho^{'} = (\\gamma RT_{0})\\rho^{'}$   Can take partials w.r.t time and replace $\\rho^{'}$ with $P^{'}$ and eventually, you get a wave equation:  $\\frac{\\partial^{2}P^{'}}{\\partial t^{2}} = c_{s}^{2}\\nabla^{2}P^{'}$ where $c_{s}^{2} = \\gamma RT$ is the speed of sound      Chapter 2 Why a rotating frame?  We live on Earth. Earth rotates. We should use a rotating frame to describe the Navier Stokes equations By translating to a rotating frame, we remove the “solid body” rotation   We have the Earth with a thin layer of fluid on its surface. It rotates around the z axis. The atmosphere gets “dragged” along by the Earth (the solid body) and rotates together with the Earth at a rate of $2\\pi$ per day up down velocity (vertical) is zero ($w=0$) North South velocity is zero ($v=0$) East West velocity is only a function of latitude $\\theta$ (ie. $u=u(\\theta)$)  Radius of Earth is 6400 km. So $u(\\theta=0) = 465 \\frac{m}{s}$. This is typically orders of magnitude larger than any relevant phenomena      Derivation of Velocity and Acceleration in Rotating Frames  Consider a constant length vector $\\vec{v}$ (originating from the origin) rotating around an axis $\\vec{\\Omega}$. Longitude in xy plane denoted by $\\lambda$ and latitude denoted by $\\theta$. We can always choose $\\vec{\\Omega}$ to lie along the z-axis.  $(\\frac{d\\vec{v}}{dt})_{I} = \\Omega \\times \\vec{v}$  rate of change of $\\vec{v}$ in the inertial frame     consider a vector $\\vec{B}$ that varies in time  $\\frac{d\\vec{B_{I}}}{dt} = \\frac{d\\vec{B_{r}}}{dt}+ \\Omega\\times\\vec{B}$ Ie. The inertial change over time is related to the rotating change over time with the addition of the rotation velocity This applies to the position vector $\\vec{r}$ as well. We can interpret the time derivatives as velocities in their respective frames   Take the time derivative of the velocity terms. The time derivative formula above still holds for the velocity vectors (use $\\vec{v_{I}}$ instead of $\\vec{r}$). You then replace all the inertial frame values with rotating frame values. You eventually get: $\\frac{d\\vec{v_{I}}}{dt^2} = \\frac{d\\vec{v_{r}}}{dt^2}+2\\Omega\\times\\vec{v}_{r}+\\Omega\\times(\\Omega\\times\\vec{r})$ $2\\Omega\\times\\vec{v_{r}}$ is the Coriolis force.  This does no work because it is orthogonal to the direction of motion   $\\Omega\\times(\\Omega\\times\\vec{r})$ is the centifugal force  It is a potential force (ie. only depends on position) $\\Omega\\times\\vec{r_{\\perp}} = \\Omega\\times\\vec{r}$ Recall the CAB-BAC rule:  $\\vec{A}\\times\\vec{B}\\times\\vec{C} = (\\vec{C}\\cdot\\vec{A})\\vec{B} -(\\vec{B}\\cdot\\vec{A})\\vec{C}$   The CAB-BAC rule can be used to simplify the Centrifugal force to $-\\Omega^{2}\\vec{r_{\\perp}} = -\\nabla \\Phi_{centrifugal}$, where $\\Phi_{centrifugal} = \\frac{\\Omega^{2}r^{2}}{2}$ We can redefine the potential such that we can ignore the centrifugal force    Fluid Equations in Rotating Frame  In the rotating frame, we find that  $\\frac{d\\vec{v}}{dt} = 2\\Omega\\times\\vec{v} = \\frac{-\\nabla P}{\\rho} -\\nabla \\Phi - \\nu \\nabla^{2}\\vec{v}$   The material derivative is unchanged when shifting frames  $\\frac{D\\rho_{R}}{\\cancel{D}t}=\\frac{D\\rho_{I}}{\\cancel{D}t} \\rightarrow \\frac{D}{\\cancel{D}t}\\rho +\\rho \\nabla \\cdot \\vec{v} = 0$  Time derivative is trivially unchanged. The $\\nabla\\cdot v$ term is zero when you expand out in terms of components     Conservation of Energy is $\\frac{D}{Dt}\\Eta = 0$ and $\\Eta = (\\frac{P}{P_{0}})^{\\kappa}$ are unchanged  Encoding The Spherical Earth in Equations   We draw a sphere and make the x,y,z projections  Define $\\lambda$ to be the longitude (east to west) that varies from 0 to $2\\pi$, $\\theta$ to be the latitude(north to south) that varies from $\\frac{-\\pi}{2}$ to $\\frac{\\pi}{2}$, and $r$ is the distance from the center of the earth The velocities can be written as $\\vec{v} = (u,v,w) = (r\\cos\\theta \\frac{D\\lambda}{\\cancel{D}t}, r\\frac{D\\theta}{\\cancel{D}t}, \\frac{Dr}{\\cancel{D}t}) = u\\hat{i}+v\\hat{j}+w\\hat{k}$ To find $\\frac{D\\vec{v}}{\\cancel{D}t}$, you have to remember that the basis vectors are no longer constant; they change with time.  $\\frac{D\\hat{i}}{\\cancel{D}t} = \\frac{u}{\\cos\\theta}(\\sin\\theta\\hat{j}-\\cos\\theta\\hat{k})$ $\\frac{D\\hat{j}}{\\cancel{D}t} = \\frac{-u}{r} \\tan\\theta \\hat{j}-\\frac{v}{r}\\hat{k}$ $\\frac{D\\hat{k}}{\\cancel{D}t} = \\frac{u}{r}\\hat{i}+\\frac{v}{r}\\hat{j}$     You get the spherical versions of the fluid equations with the above substitutions. Way too complicated. Practically, we need to approximate  Primitive Equations (Dynamical Core, because you can’t get rid of the air)  Some approximations we can make:  Let $r = z+a$, where a is the radius of the Earth and z is the position in the atmosphere (z« a). This means that $\\frac{1}{r} = \\frac{1}{a}$ and $\\frac{\\partial}{\\partial r} = \\frac{\\partial}{\\partial z}$  called the shallow fluid approximation   Assume that w « v and w « u  Kills all terms quadratic in velocities that involve w (metric terms) Kills the Coriolis terms involving w   Make the momentum equation in R hydrostatic (no dependency on time) Define $\\vec{v} = u+\\hat{i}+v\\hat{j}+w\\hat{k}$ and $\\vec{u} = u+\\hat{i}+v\\hat{j}$ (ie. we can ignore w term) We then get:  $\\frac{D\\vec{u}}{\\cancel{D}t}+\\vec{f}\\times\\vec{u} = \\frac{\\nabla_{z} P}{\\rho}$  $\\vec{f} = 2\\Omega\\sin\\theta\\hat{k}$ is called the Coriolis parameter   $\\frac{D\\vec{\\rho}}{\\cancel{D}t}+\\rho \\nabla \\cdot \\vec{v} = 0$ $\\frac{D\\Eta}{\\cancel{D}t} = 0$ $\\frac{\\partial p}{\\partial z}= -\\rho g$      What is $\\vec{f}$ physically  Recall that $(\\vec{v}\\cdot \\nabla)\\vec{v} = (\\nabla\\times\\vec{v})\\times\\vec{v}+\\frac{1}{2}\\nabla|\\vec{v}|^{2}$  Define $\\nabla\\times\\vec{v}=\\omega$ as the vorticity of the flow (or the relative vorticity)   Plug this into the momentum equation shows you that we can interpret $\\vec{f}$ as a vorticity (planetary vorticity) because it gets added to $\\omega$ We define $\\vec{\\zeta}$ as the Vorticity in the direction orthogonal to the surface of the Earth (ie $\\vec{\\zeta} = \\vec{\\omega}\\cdot\\hat{k}$)  Stratification Boussinesq Equation  Key Idea: Density variation due to fluid motions are small compared to the mean density. Hence, density variations only affect fluid motion when coupled with gravity let $\\rho(x,y,z,t) = \\rho_{0}+\\delta\\rho(x,y,z,t)$ where $\\delta\\rho$ is the varying part of the density  Make the assumption that $\\frac{\\delta \\rho}{\\rho_{0}} \\ll 1$   Define a pressure field that is in hydrostatic balance with $\\rho_{0}$  $p = p_{0}+\\delta p(x,y,z,t)$ $\\frac{dp_{0}}{dz} = -\\rho_{0}g$ (variation in pressure due to constant density)   From the momentum equation, linearize w.r.t. $\\rho$ and $p$ using the above equations  Assume that $\\nabla\\Phi_{g} = -g\\hat{k}$   Throw away $\\delta \\rho$ on the LHS since it is small compared to $\\rho_{0}$ Defining $b = -g\\frac{\\delta\\rho}{\\rho}$ and $\\frac{\\delta P}{\\rho_{0}} = \\phi$ yields that  $\\frac{D\\vec{v}}{\\cancel{D}t}+2 \\Omega \\times \\vec{v} = -\\nabla\\phi+b$ $\\phi$ is the pressure variation b is buoyancy = density variation $b = -g\\frac{\\delta p}{p_0}$   You can do a similar process with the continuity equation and only keep first order terms to yield  $\\nabla\\cdot\\vec{v} = 0$ or physically, your fluid is incompressible   Going back to thermodynamics, recall that  $\\frac{D\\rho}{\\cancel{D}t}-\\frac{1}{c-{s}^{2}}\\frac{Dp}{\\cancel{D}t} = DiabaticTerms$  the speed of propagation is $c_{s}$, which is given by $c_{s}^{2} = \\frac{\\partial P}{\\partial \\rho}_{\\eta}$ where $\\eta$ is the entropy Let the speed of propagation $c_{s}\\rightarrow \\infty$, take derivate of the constant term $\\rho_{0}$ and multiply and divide by some constants to yield  $\\frac{Db}{\\cancel{D}t} = \\dot{b}$     5 equations (3 from momentum, 1 incompressible equation, 1 thermo) and 5 unknowns ($u,v,w,\\phi,b$)    Anelastic Equations  Assume that $\\theta = \\tilde{\\theta}+\\delta\\theta$ and that $b_{a} = g\\frac{\\delta\\theta}{\\theta}$ Linearize w.r.t. to $\\rho$ and $p$ and assume hydrostatic relation $\\frac{\\partial \\tilde{P}}{\\partial z} = -\\tilde{\\rho}(z)g$. (~ denotes the constant term). We make the assumption that $\\delta\\theta \\ll \\theta$, which is a bad approximation for the atmosphere (but good for astrophysical fluids) Chugging through yields  $\\frac{D\\vec{v}}{\\cancel{D}t} + 2\\Omega\\times\\vec{v} = -\\nabla\\Phi +b_{a}\\hat{k}$ $\\frac{Db_{a}}{\\cancel{D}t} = \\dot{b_{a}}$ $\\nabla(\\tilde{\\rho}\\vec{v}) = 0$    Alternative Vertical Coordinates  Let $\\xi$ denote whatever your vertical coordinate is (pressure, log pressure, z, $\\theta$ etc.) We can rewrite $z = z(x,y,\\xi,t)$ Let $Q = Q(x,y,z,t)$ $(\\frac{\\partial Q}{\\partial x})_{\\xi}$ can be replaced with  $(\\frac{\\partial Q}{\\partial x})_{z}$ added to $\\frac{\\partial Q}{\\partial z}(\\frac{\\partial z}{\\partial x})_{\\xi}$   Going back to the primitive equations, if you let $Q=\\xi=P$, you can replace z with $P$. This simplifies the equation, but the cost is that the boundary conditions are no longer straight forward  Under What Conditions does Hydrostatic Balance Holds? Without Rotation  Write out Boussinesq equations as  $\\frac{D\\vec{u}}{\\cancel{D}t}+2\\vec{\\Omega}\\times\\vec{u} = -\\nabla\\phi$ $\\frac{Dw}{\\cancel{D}t} = -\\frac{\\partial \\phi}{\\partial z}+b$ $\\nabla \\cdot \\vec{v} = 0$ $\\frac{D b}{\\cancel{D}t} =\\dot{b}$   Initially, we ignore rotation $\\Omega = 0$. Assign a scale parameter to each independent variable in our equations  $x,y \\approx L$ $u,v \\approx U$ $t \\approx \\frac{L}{U}$ $w \\approx W$ $z \\approx H$   From x,y momentum equation we get $\\frac{U}{L}U \\approx \\frac{1}{L}\\phi \\rightarrow \\phi \\approx U^{2}$ From Incompressibility, we get that $\\frac{U}{L} \\approx \\frac{W}{H} \\rightarrow W \\approx \\frac{H}{L}U$ From z momentum equation, we get that $\\frac{dW}{dt} \\approx \\frac{U^2}{L^2}H$ and $\\frac{d\\phi}{dz} \\approx \\frac{U^2}{H}$. The ratio of these terms is $((\\frac{H}{L})^2)$  If H is smaller than L, then the variation in vertical acceleration is much less than acceleration due to the vertical pressure gradient (in a quadratic sense). Hence, hydrostatic balance is a good approximation    Adding Stratification  Let $b(x,y,z,t) = \\tilde{b}(z)+{b}'(x,y,z,t)$  $\\tilde{b}$ is the given stratification ${b}‘$ are changes in b that move with the motion   Analogously, $\\phi = \\tilde{\\phi}(z)+\\phi'$  We define $\\frac{\\partial {\\phi}'}{\\partial z} = {b}‘$   Let $\\dot{b} = 0$. Then $\\frac{Db}{\\cancel{D}t} = 0 \\rightarrow w \\frac{\\partial \\tilde{b}}{\\partial t}+\\frac{Db’}{\\cancel{D}t} = 0$  Define $\\frac{\\partial \\tilde{b}}{\\partial t} = N^{2}$ Hence $\\frac{Db’}{\\cancel{D}t}+wN^{2} = 0$   Plug in $\\phi$ and b in terms of tilde and ' terms, then simplify Doing scale analysis in an exactly analogous manner to the previous section to get $\\frac{U^2}{H^2} \\approx N^2$  For the Ocean, U ~ 0.1 m/s, H ~ 1km, N ~ 1E-2 s^{-1}. Hence $\\frac{U^2}{H^2N^2} \\approx 1E-4$. Not even close to 1 This means that the scaling that was used in the case without stratification is not appropriate  Instead of scaling $N^2$, we scale w instead  Define the Froude number: $Fr = \\frac{U}{NH}$ $w = (Fr)^2\\frac{H}{L}U$. This enables proper scaling     Going back to hydrostatic balance: $\\frac{Dw}{\\cancel{D}t} = -\\frac{\\partial \\phi’}{\\partial z}+b'$  Doing the scaling analysis to get that $(Fr)^2(\\frac{H}{L})^2\\frac{U^2}{L} \\approx \\frac{U^2}{L}$ Taking the ratio of the LHS to the RHS yields that $\\frac{\\frac{Dw}{\\cancel{D}t}}{b’} \\approx (Fr)^2(\\frac{H}{L})^2$  Because of the squared Froude number, hydrostatic balance is an even better approximation  If you have strong stratification ($FR « 1$), this apply hydrostatic balance to deep fluids (ie $\\frac{H}{L}$ need not be small)          With Rotation  We now let $\\Omega$ be nonzero Looking at the horizontal momentum equation  $\\frac{D}{\\cancel{D}t}\\vec{u} + \\vec{f}\\times\\vec{u} = \\frac{-1}{\\rho}\\nabla p$  $\\vec{f} = 2\\Omega \\sin\\theta \\hat{k}$   Apply scalar analysis to the this equation (f has units of $f$) to get that the ratio of the horizontal acceleration to the coreolis acceleration is  $\\frac{\\frac{U^2}{L}}{fU} \\approx \\frac{U}{fL} = R_o$ $R_o$ is the Rossby number $\\Omega = \\frac{2\\pi}{24\\ hr}$ is 7.27E-5 Hz f at mid latitudes ($\\theta = 45$) is 1E-4 1/s For the atmosphere, $R_o \\approx 0.1 « 1$ For the ocean, $R_o \\approx 0.01 « 1$   Rapidly rotating fluids have small $R_0$    Time scales  We can define time scales in an analagous manner Advective: $\\frac{L}{U} \\approx$ 27 hrs for the atmosphere and 1E6 hrs for the ocean Rotation: $\\frac{1}{f} \\approx $ 3 hrs for Earth GFD forces are slow in comparison to rotation.  This means that we can drop $\\frac{Du}{\\cancel{D}t}$  $\\vec{f}\\times \\vec{u_g} = \\frac{-1}{\\rho}\\nabla p$  This is called Geostrophic balance   In spherical coordinates, you can write the above as $fv_g = \\frac{1}{a\\rho \\cos \\theta}\\frac{\\partial p}{\\partial \\lambda}$ and $fu_g = \\frac{-1}{a\\rho}\\frac{\\partial p}{\\partial \\theta}$ where $\\theta$ is latitude and $\\lambda$ is longitude      Geostrophic flow  Flow along lines of constant pressure w/ high pressure to the right for $f  0$ From horizontal momentum equations, we know (if f and $\\rho$ are constant) that $\\nabla u_g = 0$ and $\\zeta_g = \\hat{k} \\cdot \\nabla \\times u_g = \\frac{1}{\\rho_0 f_{0}} \\nabla^2 p$  If you are give the vorticity $\\zeta_{g}$, then you can solve Poisson’s equation to solve for P   We can modify this by letting $f = f_0+\\beta y$. This causes the rotation to be felt more at the poles and less at the equator Plugging this into the geostrophic balance equation and turning the crank (taking mixed partials, equating and doing derivative) yields  $f \\frac{\\partial w}{\\partial z} = \\beta v_g$ This is called the Sverdrup balance    Taylor-Proudman Theorem  If $\\beta=0$, $f = f_0$, and $\\rho = \\rho_0$ then $\\frac{\\partial w}{\\partial z} = 0$ In words, geostrophy + hydrostatic balance+ constant f and rho implies that the geostrophic flow is independent of height  Thermal Wind Balance  Combine geostrophy and hydrostatic balance with Bousinesq  $\\vec{f}\\times \\vec{u_g} = -\\nabla \\phi$ $\\frac{\\partial \\phi }{\\partial x} = b$   Take $\\frac{\\partial }{\\partial z}$ of the first and use the second to demonstrate that  $\\vec{f}\\times\\frac{\\partial \\vec{u}_g}{\\partial z} = -\\nabla b$ In Component form:  $\\frac{\\partial u_g}{\\partial z} = -\\frac{\\partial b}{\\partial y}$ $\\frac{\\partial v_g}{\\partial z} = \\frac{\\partial b}{\\partial x}$   Use the equation of state $\\rho = \\rho_0[1-\\beta(T-T_0)]$  Since $b = -\\frac{\\delta \\rho}{\\rho}, g$ Hot water is light water which is buoyant water      Gravity Waves  Suppose that we have an incompressible fluid $\\nabla\\cdot v = 0$ and that $\\frac{D b}{\\cancel{D}t} = 0$ Boussinesq states that  $\\frac{Du}{\\cancel{D}t} = -\\nabla\\phi$ $\\frac{Dw}{\\cancel{D}t} = -\\frac{\\partial \\phi}{\\partial z}+b$ We want to linearize around a stationary point  For simplicity, assume we are in 2D  $u = u(x,z,t)$ $v = u(x,z,t)$ $w=0$   Linearize $\\phi$ and $b$ into ~ and ' parts and assume hydrostatic balance $\\frac{\\partial \\tilde{\\phi}}{\\partial z} = \\tilde{b}$  $u_t^{'} = -\\phi_x^{'}$ $w_t^{'} = -\\phi_z^{'}+b'$ $u_x^{'} = -w_z^{'}$ $b_t^{'} = -w^{'}N^2$   Taking the appropriate partials and writing everything in terms of w to get that  $w_{ttxx}^{'} +w_{zztt}^{'}+N^{2}w_{xx}^{'}$ Assume solutions of the form $w = W exp(i(kx+mz-\\omega t))$ The dispersion relation is then: $\\omega = \\frac{N^2k^2}{k^2+m^2} \\rightarrow \\frac{\\omega}{N} = \\sqrt{\\frac{\\kappa^2}{1+\\kappa^2}}$ As $\\kappa$ goes to zero, the horizontal motion is much greater than the vertical motion. The horizontal motion must complete in time with the the vertical motion. Hence small $\\omega$ Conversely, if the vertical motion is much greater than the horizontal motion, then $\\omega \\rightarrow N$, or the maximum allows frequency due to gravity        Shallow Water Theory  One layer of constant density $\\rho_0$ , possibly rotating, bounded by a rigid surface below and a free surface above  Let $\\eta_b(x,y)$ be the surface of the rigid surface below Let h be the distance between the free surface and the rigid surface Let $\\eta$ be the distance between the free surface to the reference level $z=0$ Assume hydrostatic balance $\\frac{dP}{dt} = -\\rho_0 g$  $P(x,y,z,t) = -\\rho_o g\\zeta+P_o$  Let $P_0 = 0$ when $z = \\eta$   We then can say that $P(x,y,z,t) = \\rho_0 g (\\eta(x,y,t)-z)$ Take partials w.r.t. x and y and observe that gradients of pressure (forces) are independent of theory $\\frac{D\\vec{u}}{\\cancel{D}t} + \\vec{f}\\times \\vec{u} = \\frac{-1}{\\rho_0}\\nabla P = -g \\nabla \\eta$  $\\vec{u} = u\\hat{i}+v\\hat{j}$   We also need conservation of mass $\\nabla \\cdot \\vec{v} = 0 \\rightarrow \\frac{\\partial w}{\\partial z} = -\\nabla \\cdot \\vec{u}$  Integrate along z from $\\eta_b$ to $\\eta$  $w(\\eta)-w(\\eta_b) = -\\nabla\\cdot u (\\eta-\\eta_b)$ Note that $w(\\eta) = \\frac{D\\eta}{\\cancel{D}t}$ and that $w(\\eta_b) = \\frac{D\\eta_b}{\\cancel{D}t} \\neq 0$ due to positional changes $\\frac{D}{\\cancel{D}t}(\\eta-\\eta_b)+h \\nabla\\cdot u = 0 \\rightarrow \\frac{\\partial \\eta}{\\partial t} +\\nabla \\cdot [(\\eta-\\eta_b)\\vec{u}]=0$     $\\frac{D}{\\cancel{D}t}\\frac{z-\\eta_b}{\\eta-\\eta_b}=0$  This comes from integrating conservation of mass from $z=\\eta_b$ to z and then making the substitution $\\nabla \\cdot \\vec{u} = \\frac{-1}{h}\\frac{Dh}{\\cancel{D}t} = \\frac{-1}{\\eta-\\eta_b}\\frac{D}{\\cancel{D}t}(\\eta-\\eta_b)$ This states that no water flows up or down the column in shallow water equations (“no social mobility”) $\\frac{z-\\eta_b}{\\eta-\\eta_b}=0$ is a conserved quantity   Another important quantity is $\\nabla \\times \\vec{v}$ or the vorticity. Since we have a 2D flow, we only care about the k component: $\\nabla\\times\\vec{u}\\cdot\\hat{k} = \\frac{\\partial u}{\\partial x}-\\frac{\\partial u}{\\partial y} = \\zeta$  Importantly, Vorticity is NOT a conserved quantity However, $\\frac{D}{\\cancel{D}t}(\\frac{\\zeta+f}{h}) = 0$ is conserved   Kinetic Energy  $\\frac{KE}{Vol} = \\int_{\\eta}^{\\eta_a} \\rho_0\\frac{\\vec{u}^2}{2} dz = \\rho_0\\frac{\\vec{u}^2}{2} (\\eta-\\eta_b)$   Potential Energy  $\\int_{\\eta_b}^{\\eta} \\rho_0 g z dz = \\rho_o g(\\eta^2-\\eta_b^2)$   Setting $\\eta_b=0$ and take $\\frac{\\partial}{\\partial t}$ of the KE and PE sum. After lots of algebra:  $\\frac{\\partial}{\\partial t}(EK+PE)+\\nabla\\cdot(\\vec{u}(gh^2+\\frac{h\\vec{u}^{2}}{2})) = 0 \\rightarrow \\frac{\\partial E}{\\partial t}(E) = \\nabla\\cdot F = 0$ Using Stoke’s Law on the entire volume under consideration:  $\\frac{\\partial}{\\partial t}\\int E dA+\\oint \\vec{F}\\cdot\\hat{n}\\vec{dl} = 0$ Since $\\vec{u}$ is orthogonal to $\\hat{n}$, the closed integral is zero. Hence energy E is conserved          Gas Dynamics Connection  Shallow Water Equations with $\\vec{f}=0$ and $\\eta_b = 0$ $\\frac{D\\vec{u}}{\\cancel{D}t} = -g\\nabla \\eta$ $\\frac{\\partial \\eta}{\\partial t}+ \\nabla\\cdot (\\eta\\vec{u}) = 0$ Gass Dynamics  $\\frac{D\\vec{u}}{\\cancel{D}t} = \\frac{-1}{\\rho} \\nabla P$ $\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho\\vec{u}) = 0$ Equation of state $P = C\\rho^{\\gamma}$   If we let $\\gamma = 2$ and $C\\gamma = g$, the above as isomorphic If you linearize both equations, these are isomorphic for all $\\gamma$  Reduced Gravity Model  You have two fluid layers $\\rho_1$ and $\\rho_2$. Let $\\rho_1 We integrate the hydrostatic balance equation from $\\eta_0$ to z where z is not in in the stationary layer  $P_1 = g\\rho_1(\\eta_0-z)$ $\\frac{1}{\\rho_1}\\nabla(P_1) = g \\nabla \\eta_0$ $\\frac{D\\vec{u}}{\\cancel{D}t} = \\vec{f}\\times \\vec{u} = -g\\nabla \\eta_0$   We can then integrate up to $\\eta_1$ in layer 1, then from $\\eta_1$ to z in layer 2 $P_2 = \\rho_1 g(\\eta_0-\\eta_1)+\\rho_2 g(\\eta_1-z)$ This can be rearranged to $g\\eta_0 = -(\\frac{\\rho_2-\\rho_1}{\\rho_1})g\\eta_1+constants \\rightarrow g\\eta_0+g’\\eta_1 = constant$  $g’ = \\frac{\\rho_2-\\rho_1}{\\rho_1}g$ is the reduced gravity  With this, if $\\frac{\\delta \\rho}{\\rho} « 1$, then $g'«g$. This means that $\\eta_0«\\eta_1$ We can make the rigid lid approximation in this limit by settin $\\eta_0=0$ Turning the crank, we eventually find that  $(\\rho_2-\\rho_1)g\\nabla h = \\nabla P$       We eventually, with the tight lid approximation, the same equations as the shallow water equations with $g = g'$  2 Layer Shallow Water  $\\frac{D\\vec{u_1}}{\\cancel{D}t}+\\vec{f}\\times\\vec{u_2} = -g\\nabla\\eta_0$ $\\frac{D\\vec{u_2}}{\\cancel{D}t}+\\vec{f}\\times\\vec{u_2} = \\frac{-\\rho_1}{\\rho_2}(g\\nabla\\eta_0+g^{'}\\nabla\\eta_1)$  $g’ = \\frac{\\rho_2-\\rho_1}{\\rho_1}g$   There are also the conservation of mass equations, but those aren’t coupled Let’s look at steady state solutions (geostrophic ie. time partials are zero). With some algebra and vector identities  $f(\\vec{u_1-u_2}) = k\\hat{k}\\times g^{'}\\nabla\\eta_{1}$ Physically, the horizontal slope of the interface ($z = \\eta_1$) is related to vertical velocities (and vice versa) We can think of the gradient of $\\eta_1$ as a proxy for temperature (because fluctuations in density can be related to temperature)   Now let’s examine the waves that are permitted, keeping $\\eta_b = 0$  Assume a stationary medium of height N and linearize  $\\vec{u} = 0+ \\vec{u’}$ $\\eta = H+\\eta'$   $\\frac{\\partial \\vec{u’}}{\\partial t}+\\vec{f}\\times\\vec{u’} = -g \\nabla\\eta'$ $\\frac{\\partial \\vec{u’}}{\\partial t}+ H\\nabla\\cdot\\vec{u’}= 0$ For simplicity, let $\\vec{f} = 0$  We can eliminate $\\vec{u’}$ and solve for $\\eta'$. We see that we get a wave equation  $\\frac{\\partial^2\\eta’}{\\partial t^2} = (gH)\\nabla^{2}\\eta'$ the speed in the medium is $c^2 = gH$  This is why waves break at the shoreline (waves in deeper water over take waves near the beach and break)   We can solve this with phasors. Let $\\eta’ = \\eta_0 exp(i(kx-\\omega t))$. Plug in and solve for $\\omega = \\pm ck$  We see that phase velocity is c and group velocity is c This is a non-dispersive wave, so the initial shape of the wave is maintained       Now, we let $f = f_0$. This rotation couples the x and y directions  We can write everything out in component form, and then make the assumption that all the fluctionations have the form $A’ = Aexp(i(kx+lk-\\omega t))$, we can rewrite the above as a matrix equation $Ax = 0$ and solve for values of $\\omega$ that causes the matrix A to be singular (ie det A = 0)  The characteristic equation is $\\omega(\\omega^2-f_0^2-(k^2+l^2)gH) = 0$  $\\omega = 0 \\rightarrow \\frac{\\partial}{\\partial t} = 0$. Plugging back into linearized equations, we recover geostrophy and conservation of mass. We also see that $\\eta'$ is degenerate (ie any $\\eta'$ works) The other modes are $\\frac{\\omega^2}{f_0^2} = 1+\\frac{gH(k^2+l^2)}{f_0^2}$  In the limit that $k^2+l^2 » 1$, we see that we recover the non-rotating case (gravity dominated)  The wavelengths are small, hence they don’t feel the rotation of the Earth   The other limit with big wavelengths ($k^2+l^2«1$) only feel the effect of rotation and ignores gravity (rotation dominated) For these waves, if $\\eta'=0$ then there are no pressure gradients (inertial oscillations)   $L_R = \\frac{\\sqrt{g H}}{f_0}$ is the Rossby radius or the “Deformation radius”  the free surface is being deformed once you reach lengths scales above this scale ($L » L_R$) for $L « L_R$, gravity dominates            ",
  "wordCount" : "3701",
  "inLanguage": "en",
  "datePublished": "2023-01-17T22:19:05-05:00",
  "dateModified": "2023-03-13T12:25:21-04:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://mushetty.me/notes/geophysics/geophysics/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "mushetty.me",
    "logo": {
      "@type": "ImageObject",
      "url": "https://mushetty.me/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://mushetty.me" accesskey="h" title="mushetty.me (Alt + H)">mushetty.me</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://mushetty.me/simulations/" title="Simulations">
                    <span>Simulations</span>
                </a>
            </li>
            <li>
                <a href="https://mushetty.me/notes/" title="Notes">
                    <span>Notes</span>
                </a>
            </li>
            <li>
                <a href="https://mushetty.me/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Geophysical Fluid Dynamics (GFD)
    </h1>
    <div class="post-meta"><span title='2023-01-17 22:19:05 -0500 EST'>Date Created: January 17, 2023</span>&nbsp;·&nbsp;<span title='2023-03-13 12:25:21 -0400 EDT'>Last Modified: March 13, 2023</span>

</div>
  </header> 
  <div class="post-content"><p>Compilation of notes for Geophysical Fluid Dynamics class for Spring 2023.</p>
<ul>
<li><a href="#administrative-stuff">Administrative Stuff</a></li>
<li><a href="#chapter-1">Chapter 1</a>
<ul>
<li><a href="#material-derivative-lagrangian-derivative">Material Derivative (Lagrangian Derivative)</a></li>
<li><a href="#conservation-of-mass">Conservation of Mass</a></li>
<li><a href="#momentum-equation">Momentum Equation</a></li>
<li><a href="#equation-of-state">Equation of State</a></li>
<li><a href="#sound-waves">Sound Waves</a></li>
</ul>
</li>
<li><a href="#chapter-2">Chapter 2</a>
<ul>
<li><a href="#why-a-rotating-frame">Why a rotating frame?</a></li>
<li><a href="#derivation-of-velocity-and-acceleration-in-rotating-frames">Derivation of Velocity and Acceleration in Rotating Frames</a></li>
<li><a href="#fluid-equations-in-rotating-frame">Fluid Equations in Rotating Frame</a>
<ul>
<li><a href="#encoding-the-spherical-earth-in-equations">Encoding The Spherical Earth in Equations</a></li>
<li><a href="#primitive-equations-dynamical-core-because-you-cant-get-rid-of-the-air">Primitive Equations (Dynamical Core, because you can&rsquo;t get rid of the air)</a>
<ul>
<li><a href="#what-is-vecf-physically">What is $\vec{f}$ physically</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#stratification">Stratification</a>
<ul>
<li><a href="#boussinesq-equation">Boussinesq Equation</a></li>
<li><a href="#anelastic-equations">Anelastic Equations</a></li>
</ul>
</li>
<li><a href="#alternative-vertical-coordinates">Alternative Vertical Coordinates</a></li>
<li><a href="#under-what-conditions-does-hydrostatic-balance-holds">Under What Conditions does Hydrostatic Balance Holds?</a>
<ul>
<li><a href="#without-rotation">Without Rotation</a>
<ul>
<li><a href="#adding-stratification">Adding Stratification</a></li>
</ul>
</li>
<li><a href="#with-rotation">With Rotation</a></li>
<li><a href="#time-scales">Time scales</a></li>
<li><a href="#geostrophic-flow">Geostrophic flow</a></li>
<li><a href="#taylor-proudman-theorem">Taylor-Proudman Theorem</a></li>
</ul>
</li>
<li><a href="#thermal-wind-balance">Thermal Wind Balance</a></li>
<li><a href="#gravity-waves">Gravity Waves</a></li>
<li><a href="#shallow-water-theory">Shallow Water Theory</a>
<ul>
<li><a href="#gas-dynamics-connection">Gas Dynamics Connection</a></li>
<li><a href="#reduced-gravity-model">Reduced Gravity Model</a></li>
</ul>
</li>
<li><a href="#2-layer-shallow-water">2 Layer Shallow Water</a></li>
</ul>
</li>
</ul>
<h2 id="administrative-stuff">Administrative Stuff<a hidden class="anchor" aria-hidden="true" href="#administrative-stuff">#</a></h2>
<ul>
<li>Office Hours: Engineering Terrace 287 on Thursdays during class time (4:00-5:00 PM)</li>
<li>TA: Eojin Lee el3080[at]columbia.edu</li>
<li>Primary Textbook: Geoff Vallis: Atmospheric and Oceanic Fluid Dynamics 1st Edition (pdf available on Columbia Library)
<ul>
<li>Course covers Ch 1-6. Maybe Ch 8.</li>
</ul>
</li>
<li>Other texts:
<ul>
<li>J. Pedlosky: GFD</li>
<li>Adrian Gill: Atmosphere Ocean Dynamics</li>
<li>More Specialized
<ul>
<li>Rich Salmon</li>
<li>Jim McWilliams</li>
<li>Benoit Cushman-Roisin</li>
</ul>
</li>
</ul>
</li>
<li>Grading Scheme
<ul>
<li>Based on HW (6 or so)</li>
</ul>
</li>
</ul>
<h2 id="chapter-1">Chapter 1<a hidden class="anchor" aria-hidden="true" href="#chapter-1">#</a></h2>
<ul>
<li>We deal with <strong>rotating</strong> and <strong>stratified</strong> fluids
<ul>
<li>Rotating: spinning around an axis</li>
<li>Statified: a gradient in the density exists (light density higher, heavier density lower)</li>
</ul>
</li>
<li>Dealing with large scale motion of fluid (can ignore convection effects)
<ul>
<li>ocean basins</li>
<li>continental US</li>
</ul>
</li>
</ul>
<h3 id="material-derivative-lagrangian-derivative">Material Derivative (Lagrangian Derivative)<a hidden class="anchor" aria-hidden="true" href="#material-derivative-lagrangian-derivative">#</a></h3>
<ul>
<li>$\frac{D}{\cancel{D}t} = \frac{\partial}{\partial t}+ \vec{v}\cdot \nabla = \frac{\partial}{\partial t}+v_{x}\frac{\partial}{\partial x}+v_{y}\frac{\partial}{\partial y}+v_{z}\frac{\partial}{\partial z}$
<ul>
<li>The first part is the Eulerian deriviative (local change)</li>
<li>The second part is the nonlinear term (ie. the good stuff)</li>
<li>$v = \vec{v}(x,y,z,t)$</li>
</ul>
</li>
</ul>
<h3 id="conservation-of-mass">Conservation of Mass<a hidden class="anchor" aria-hidden="true" href="#conservation-of-mass">#</a></h3>
<ul>
<li>$\frac{D}{\cancel{D}t}\rho+\rho \nabla\cdot\vec{v} = 0$
<ul>
<li>$\rho = \rho(x,y,z,t)$</li>
<li>$\frac{\partial \rho}{\partial t}+\nabla \cdot (\rho \vec{v}) = 0$</li>
</ul>
</li>
</ul>
<h3 id="momentum-equation">Momentum Equation<a hidden class="anchor" aria-hidden="true" href="#momentum-equation">#</a></h3>
<ul>
<li>$\frac{\partial \vec{v}}{\partial t}+(\vec{v}\cdot\nabla)\vec{v} = \frac{-1}{\rho}\nabla P + \nu \nabla^{2}\vec{v}+F_{b}$
<ul>
<li>$\rho$ is pressure, $P$ is pressure, $\nu$ is the friction coefficient</li>
<li>First term: pressure term</li>
<li>Second term: friction term</li>
<li>Third term: &ldquo;body&rdquo; forces (most common forces: gravity, EM forces)</li>
<li>Newton Law analogy: $\vec{a}=\frac{\vec{F}}{m}$ (ie the every term is a force per unit mass)</li>
</ul>
</li>
<li>Ex: Consider an inviscid (non viscous) fluid ($\nu=0$) at rest  ($\vec{v}=0$) with gravity ($F_{b} = -g\hat{k}$)
<ul>
<li>LHS=0. 2nd term on RHS is zero. Spliting into components
<ul>
<li>$\frac{\partial \rho}{\partial x}=0$</li>
<li>$\frac{\partial \rho}{\partial y}=0$</li>
<li>$\frac{\partial \rho}{\partial z} = -\rho g \rightarrow p(z) = -\int_{z}^{TOA}\rho g\ dz$
<ul>
<li>$\rho = \rho(z)$ and $g = g(z)$ (normally a constant)</li>
<li>$TOA$ is the top of atmosphere where pressure falls to basically zero</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="equation-of-state">Equation of State<a hidden class="anchor" aria-hidden="true" href="#equation-of-state">#</a></h3>
<ul>
<li>So far, we have 4 equations and 5 unknowns ($\rho,P$ and 3 components of $\vec{v}$)</li>
<li>Need to connect $\rho$ to $P$ with an equation of state</li>
<li>Can also use a conservation law (ie. conservation of energy)</li>
</ul>
<h3 id="sound-waves">Sound Waves<a hidden class="anchor" aria-hidden="true" href="#sound-waves">#</a></h3>
<ul>
<li>Longitudinal Pressure and density waves</li>
<li>Take conservation of mass and momentum equations and linearize them (Let $\vec{v}=\vec{v_{0}+\vec{v}^{'}} $ and $\rho_{0}+\rho^{'}$, then multiply out, and drop all the quadratic terms):
<ul>
<li>$\frac{D\rho}{\cancel{D}t}+\rho\nabla\vec{v}=0\rightarrow\frac{\partial \rho^{'}}{\partial t}+\rho_{0}\nabla\cdot\vec{v^{'}} = 0$</li>
<li>$\frac{D\vec{v}}{\cancel{D}t} = \frac{-\nabla P}{\rho}\rightarrow \frac{\partial \vec{v}}{\partial t} = \frac{-\nabla P}{\rho}$</li>
<li>From thermodynamics, we know for an ideal gas that $P = c\rho^{\gamma}$. We linearize like the other equations, and then make the approximation $(1+\frac{\rho^{'}}{\rho_{0}})^{\gamma}\approx 1+\gamma(\frac{\rho^{'}}{\rho_{0}})$ and recall $P_{0}= C\rho_{0}^{\gamma}$ to get that:
<ul>
<li>$P{'} = \gamma\frac{\rho_{0}}{P_{0}}\rho^{'} = (\gamma RT_{0})\rho^{'}$</li>
</ul>
</li>
<li>Can take partials w.r.t time and replace $\rho^{'}$ with $P^{'}$ and eventually, you get a wave equation:
<ul>
<li>$\frac{\partial^{2}P^{'}}{\partial t^{2}} = c_{s}^{2}\nabla^{2}P^{'}$ where $c_{s}^{2} = \gamma RT$ is the speed of sound</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="chapter-2">Chapter 2<a hidden class="anchor" aria-hidden="true" href="#chapter-2">#</a></h2>
<h3 id="why-a-rotating-frame">Why a rotating frame?<a hidden class="anchor" aria-hidden="true" href="#why-a-rotating-frame">#</a></h3>
<ul>
<li>We live on Earth. Earth rotates. We should use a rotating frame to describe the Navier Stokes equations</li>
<li>By translating to a rotating frame, we remove the &ldquo;solid body&rdquo; rotation
<ul>
<li><img loading="lazy" src="/images/Geo/GFDSolidRotation.png" alt="FluidOnSphere"  />
</li>
<li>We have the Earth with a thin layer of fluid on its surface. It rotates around the z axis. The atmosphere gets &ldquo;dragged&rdquo; along by the Earth (the solid body) and rotates together with the Earth at a rate of $2\pi$ per day</li>
<li>up down velocity (vertical) is zero ($w=0$)</li>
<li>North South velocity is zero ($v=0$)</li>
<li>East West velocity is only a function of latitude $\theta$ (ie. $u=u(\theta)$)
<ul>
<li>Radius of Earth is 6400 km. So $u(\theta=0) = 465 \frac{m}{s}$. This is typically orders of magnitude larger than any relevant phenomena</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="derivation-of-velocity-and-acceleration-in-rotating-frames">Derivation of Velocity and Acceleration in Rotating Frames<a hidden class="anchor" aria-hidden="true" href="#derivation-of-velocity-and-acceleration-in-rotating-frames">#</a></h3>
<p><img loading="lazy" src="/images/Geo/RotatingVector.png" alt="RotatingVector"  />
</p>
<ul>
<li>Consider a constant length vector $\vec{v}$ (originating from the origin) rotating around an axis $\vec{\Omega}$. Longitude in xy plane denoted by $\lambda$ and latitude denoted by $\theta$. We can always choose $\vec{\Omega}$ to lie along the z-axis.
<ul>
<li>$(\frac{d\vec{v}}{dt})_{I} = \Omega \times \vec{v}$
<ul>
<li>rate of change of $\vec{v}$ in the inertial frame</li>
</ul>
</li>
</ul>
</li>
<li>consider a vector $\vec{B}$ that varies in time
<ul>
<li>$\frac{d\vec{B_{I}}}{dt} = \frac{d\vec{B_{r}}}{dt}+ \Omega\times\vec{B}$</li>
<li>Ie. The inertial change over time is related to the rotating change over time with the addition of the rotation velocity</li>
<li>This applies to the position vector $\vec{r}$ as well. We can interpret the time derivatives as velocities in their respective frames</li>
</ul>
</li>
<li>Take the time derivative of the velocity terms. The time derivative formula above still holds for the velocity vectors (use $\vec{v_{I}}$ instead of $\vec{r}$). You then replace all the inertial frame values with rotating frame values. You eventually get:</li>
<li>$\frac{d\vec{v_{I}}}{dt^2} = \frac{d\vec{v_{r}}}{dt^2}+2\Omega\times\vec{v}_{r}+\Omega\times(\Omega\times\vec{r})$</li>
<li>$2\Omega\times\vec{v_{r}}$ is the Coriolis force.
<ul>
<li>This does no work because it is orthogonal to the direction of motion</li>
</ul>
</li>
<li>$\Omega\times(\Omega\times\vec{r})$ is the centifugal force
<ul>
<li>It is a potential force (ie. only depends on position)</li>
<li>$\Omega\times\vec{r_{\perp}} = \Omega\times\vec{r}$</li>
<li>Recall the CAB-BAC rule:
<ul>
<li>$\vec{A}\times\vec{B}\times\vec{C} = (\vec{C}\cdot\vec{A})\vec{B} -(\vec{B}\cdot\vec{A})\vec{C}$</li>
</ul>
</li>
<li>The CAB-BAC rule can be used to simplify the Centrifugal force to $-\Omega^{2}\vec{r_{\perp}} = -\nabla \Phi_{centrifugal}$, where $\Phi_{centrifugal} = \frac{\Omega^{2}r^{2}}{2}$</li>
<li>We can redefine the potential such that we can ignore the centrifugal force</li>
</ul>
</li>
</ul>
<h3 id="fluid-equations-in-rotating-frame">Fluid Equations in Rotating Frame<a hidden class="anchor" aria-hidden="true" href="#fluid-equations-in-rotating-frame">#</a></h3>
<ul>
<li>In the rotating frame, we find that
<ul>
<li>$\frac{d\vec{v}}{dt} = 2\Omega\times\vec{v} = \frac{-\nabla P}{\rho} -\nabla \Phi - \nu \nabla^{2}\vec{v}$</li>
</ul>
</li>
<li>The material derivative is unchanged when shifting frames
<ul>
<li>$\frac{D\rho_{R}}{\cancel{D}t}=\frac{D\rho_{I}}{\cancel{D}t} \rightarrow \frac{D}{\cancel{D}t}\rho +\rho \nabla \cdot \vec{v} = 0$
<ul>
<li>Time derivative is trivially unchanged. The $\nabla\cdot v$ term is zero when you expand out in terms of components</li>
</ul>
</li>
</ul>
</li>
<li>Conservation of Energy is $\frac{D}{Dt}\Eta = 0$ and $\Eta = (\frac{P}{P_{0}})^{\kappa}$ are unchanged</li>
</ul>
<h4 id="encoding-the-spherical-earth-in-equations">Encoding The Spherical Earth in Equations<a hidden class="anchor" aria-hidden="true" href="#encoding-the-spherical-earth-in-equations">#</a></h4>
<ul>
<li><img loading="lazy" src="/images/Geo/GeoSphericalCoordinates.png" alt="GeoSphericalCoordinates"  />
</li>
<li>We draw a sphere and make the x,y,z projections
<ul>
<li>Define $\lambda$ to be the longitude (east to west) that varies from 0 to $2\pi$, $\theta$ to be the latitude(north to south) that varies from $\frac{-\pi}{2}$ to $\frac{\pi}{2}$, and $r$ is the distance from the center of the earth</li>
<li>The velocities can be written as $\vec{v} = (u,v,w) = (r\cos\theta \frac{D\lambda}{\cancel{D}t}, r\frac{D\theta}{\cancel{D}t}, \frac{Dr}{\cancel{D}t}) = u\hat{i}+v\hat{j}+w\hat{k}$</li>
<li>To find $\frac{D\vec{v}}{\cancel{D}t}$, you have to remember that the basis vectors are no longer constant; they change with time.
<ul>
<li>$\frac{D\hat{i}}{\cancel{D}t} = \frac{u}{\cos\theta}(\sin\theta\hat{j}-\cos\theta\hat{k})$</li>
<li>$\frac{D\hat{j}}{\cancel{D}t} = \frac{-u}{r} \tan\theta \hat{j}-\frac{v}{r}\hat{k}$</li>
<li>$\frac{D\hat{k}}{\cancel{D}t} = \frac{u}{r}\hat{i}+\frac{v}{r}\hat{j}$</li>
</ul>
</li>
</ul>
</li>
<li>You get the spherical versions of the fluid equations with the above substitutions. Way too complicated. Practically, we need to approximate</li>
</ul>
<h4 id="primitive-equations-dynamical-core-because-you-cant-get-rid-of-the-air">Primitive Equations (Dynamical Core, because you can&rsquo;t get rid of the air)<a hidden class="anchor" aria-hidden="true" href="#primitive-equations-dynamical-core-because-you-cant-get-rid-of-the-air">#</a></h4>
<ul>
<li>Some approximations we can make:
<ul>
<li>Let $r = z+a$, where a is the radius of the Earth and z is the position in the atmosphere (z&laquo; a). This means that $\frac{1}{r} = \frac{1}{a}$ and $\frac{\partial}{\partial r} = \frac{\partial}{\partial z}$
<ul>
<li>called the shallow fluid approximation</li>
</ul>
</li>
<li>Assume that w &laquo; v and w &laquo; u
<ul>
<li>Kills all terms quadratic in velocities that involve w (metric terms)</li>
<li>Kills the Coriolis terms involving w</li>
</ul>
</li>
<li>Make the momentum equation in R hydrostatic (no dependency on time)</li>
<li>Define $\vec{v} = u+\hat{i}+v\hat{j}+w\hat{k}$ and $\vec{u} = u+\hat{i}+v\hat{j}$ (ie. we can ignore w term)</li>
<li>We then get:
<ul>
<li>$\frac{D\vec{u}}{\cancel{D}t}+\vec{f}\times\vec{u} = \frac{\nabla_{z} P}{\rho}$
<ul>
<li>$\vec{f} = 2\Omega\sin\theta\hat{k}$ is called the Coriolis parameter</li>
</ul>
</li>
<li>$\frac{D\vec{\rho}}{\cancel{D}t}+\rho \nabla \cdot \vec{v} = 0$</li>
<li>$\frac{D\Eta}{\cancel{D}t} = 0$</li>
<li>$\frac{\partial p}{\partial z}= -\rho g$</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="what-is-vecf-physically">What is $\vec{f}$ physically<a hidden class="anchor" aria-hidden="true" href="#what-is-vecf-physically">#</a></h5>
<ul>
<li>Recall that $(\vec{v}\cdot \nabla)\vec{v} = (\nabla\times\vec{v})\times\vec{v}+\frac{1}{2}\nabla|\vec{v}|^{2}$
<ul>
<li>Define $\nabla\times\vec{v}=\omega$ as the vorticity of the flow (or the relative vorticity)</li>
</ul>
</li>
<li>Plug this into the momentum equation shows you that we can interpret $\vec{f}$ as a vorticity (planetary vorticity) because it gets added to $\omega$</li>
<li>We define $\vec{\zeta}$ as the Vorticity in the direction orthogonal to the surface of the Earth (ie $\vec{\zeta} = \vec{\omega}\cdot\hat{k}$)</li>
</ul>
<h3 id="stratification">Stratification<a hidden class="anchor" aria-hidden="true" href="#stratification">#</a></h3>
<h4 id="boussinesq-equation">Boussinesq Equation<a hidden class="anchor" aria-hidden="true" href="#boussinesq-equation">#</a></h4>
<ul>
<li>Key Idea: Density variation due to fluid motions are small compared to the mean density. Hence, density variations only affect fluid motion when coupled with gravity</li>
<li>let $\rho(x,y,z,t) = \rho_{0}+\delta\rho(x,y,z,t)$ where $\delta\rho$ is the varying part of the density
<ul>
<li>Make the assumption that $\frac{\delta \rho}{\rho_{0}} \ll 1$</li>
</ul>
</li>
<li>Define a pressure field that is in hydrostatic balance with $\rho_{0}$
<ul>
<li>$p = p_{0}+\delta p(x,y,z,t)$</li>
<li>$\frac{dp_{0}}{dz} = -\rho_{0}g$ (variation in pressure due to constant density)</li>
</ul>
</li>
<li>From the momentum equation, linearize w.r.t. $\rho$ and $p$ using the above equations
<ul>
<li>Assume that $\nabla\Phi_{g} = -g\hat{k}$</li>
</ul>
</li>
<li>Throw away $\delta \rho$ on the LHS since it is small compared to $\rho_{0}$</li>
<li>Defining $b = -g\frac{\delta\rho}{\rho}$ and $\frac{\delta P}{\rho_{0}} = \phi$ yields that
<ul>
<li>$\frac{D\vec{v}}{\cancel{D}t}+2 \Omega \times \vec{v} = -\nabla\phi+b$</li>
<li>$\phi$ is the pressure variation</li>
<li>b is buoyancy = density variation</li>
<li>$b = -g\frac{\delta p}{p_0}$</li>
</ul>
</li>
<li>You can do a similar process with the continuity equation and only keep first order terms to yield
<ul>
<li>$\nabla\cdot\vec{v} = 0$</li>
<li>or physically, your fluid is incompressible</li>
</ul>
</li>
<li>Going back to thermodynamics, recall that
<ul>
<li>$\frac{D\rho}{\cancel{D}t}-\frac{1}{c-{s}^{2}}\frac{Dp}{\cancel{D}t} = DiabaticTerms$
<ul>
<li>the speed of propagation is $c_{s}$, which is given by $c_{s}^{2} = \frac{\partial P}{\partial \rho}_{\eta}$ where $\eta$ is the entropy</li>
<li>Let the speed of propagation $c_{s}\rightarrow \infty$, take derivate of the constant term $\rho_{0}$ and multiply and divide by some constants to yield
<ul>
<li>$\frac{Db}{\cancel{D}t} = \dot{b}$</li>
</ul>
</li>
</ul>
</li>
<li>5 equations (3 from momentum, 1 incompressible equation, 1 thermo) and 5 unknowns ($u,v,w,\phi,b$)</li>
</ul>
</li>
</ul>
<h4 id="anelastic-equations">Anelastic Equations<a hidden class="anchor" aria-hidden="true" href="#anelastic-equations">#</a></h4>
<ul>
<li>Assume that $\theta = \tilde{\theta}+\delta\theta$ and that $b_{a} = g\frac{\delta\theta}{\theta}$</li>
<li>Linearize w.r.t. to $\rho$ and $p$ and assume hydrostatic relation $\frac{\partial \tilde{P}}{\partial z} = -\tilde{\rho}(z)g$. (~ denotes the constant term).</li>
<li>We make the assumption that $\delta\theta \ll \theta$, which is a bad approximation for the atmosphere (but good for astrophysical fluids)</li>
<li>Chugging through yields
<ul>
<li>$\frac{D\vec{v}}{\cancel{D}t} + 2\Omega\times\vec{v} = -\nabla\Phi +b_{a}\hat{k}$</li>
<li>$\frac{Db_{a}}{\cancel{D}t} = \dot{b_{a}}$</li>
<li>$\nabla(\tilde{\rho}\vec{v}) = 0$</li>
</ul>
</li>
</ul>
<h3 id="alternative-vertical-coordinates">Alternative Vertical Coordinates<a hidden class="anchor" aria-hidden="true" href="#alternative-vertical-coordinates">#</a></h3>
<ul>
<li>Let $\xi$ denote whatever your vertical coordinate is (pressure, log pressure, z, $\theta$ etc.)</li>
<li>We can rewrite $z = z(x,y,\xi,t)$</li>
<li>Let $Q = Q(x,y,z,t)$</li>
<li>$(\frac{\partial Q}{\partial x})_{\xi}$ can be replaced with
<ul>
<li>$(\frac{\partial Q}{\partial x})_{z}$ added to</li>
<li>$\frac{\partial Q}{\partial z}(\frac{\partial z}{\partial x})_{\xi}$</li>
</ul>
</li>
<li>Going back to the primitive equations, if you let $Q=\xi=P$, you can replace z with $P$. This simplifies the equation, but the cost is that the boundary conditions are no longer straight forward</li>
</ul>
<h3 id="under-what-conditions-does-hydrostatic-balance-holds">Under What Conditions does Hydrostatic Balance Holds?<a hidden class="anchor" aria-hidden="true" href="#under-what-conditions-does-hydrostatic-balance-holds">#</a></h3>
<h4 id="without-rotation">Without Rotation<a hidden class="anchor" aria-hidden="true" href="#without-rotation">#</a></h4>
<ul>
<li>Write out Boussinesq equations as
<ul>
<li>$\frac{D\vec{u}}{\cancel{D}t}+2\vec{\Omega}\times\vec{u} = -\nabla\phi$</li>
<li>$\frac{Dw}{\cancel{D}t} = -\frac{\partial \phi}{\partial z}+b$</li>
<li>$\nabla \cdot \vec{v} = 0$</li>
<li>$\frac{D b}{\cancel{D}t}  =\dot{b}$</li>
</ul>
</li>
<li>Initially, we ignore rotation $\Omega = 0$.</li>
<li>Assign a scale parameter to each independent variable in our equations
<ul>
<li>$x,y \approx L$</li>
<li>$u,v \approx U$</li>
<li>$t \approx \frac{L}{U}$</li>
<li>$w \approx W$</li>
<li>$z \approx H$</li>
</ul>
</li>
<li>From x,y momentum equation we get $\frac{U}{L}U \approx \frac{1}{L}\phi \rightarrow \phi \approx U^{2}$</li>
<li>From Incompressibility, we get that $\frac{U}{L} \approx \frac{W}{H} \rightarrow W \approx \frac{H}{L}U$</li>
<li>From z momentum equation, we get that $\frac{dW}{dt} \approx \frac{U^2}{L^2}H$ and $\frac{d\phi}{dz} \approx \frac{U^2}{H}$. The ratio of these terms is $((\frac{H}{L})^2)$
<ul>
<li>If H is smaller than L, then the variation in vertical acceleration is much less than acceleration due to the vertical pressure gradient (in a quadratic sense). Hence, hydrostatic balance is a good approximation</li>
</ul>
</li>
</ul>
<h5 id="adding-stratification">Adding Stratification<a hidden class="anchor" aria-hidden="true" href="#adding-stratification">#</a></h5>
<ul>
<li>Let $b(x,y,z,t) = \tilde{b}(z)+{b}'(x,y,z,t)$
<ul>
<li>$\tilde{b}$ is the given stratification</li>
<li>${b}&lsquo;$ are changes in b that move with the motion</li>
</ul>
</li>
<li>Analogously, $\phi = \tilde{\phi}(z)+\phi'$
<ul>
<li>We define $\frac{\partial {\phi}'}{\partial z} = {b}&lsquo;$</li>
</ul>
</li>
<li>Let $\dot{b} = 0$. Then $\frac{Db}{\cancel{D}t} = 0 \rightarrow w \frac{\partial \tilde{b}}{\partial t}+\frac{Db&rsquo;}{\cancel{D}t} = 0$
<ul>
<li>Define $\frac{\partial \tilde{b}}{\partial t} = N^{2}$</li>
<li>Hence $\frac{Db&rsquo;}{\cancel{D}t}+wN^{2} = 0$</li>
</ul>
</li>
<li>Plug in $\phi$ and b in terms of tilde and ' terms, then simplify</li>
<li>Doing scale analysis in an exactly analogous manner to the previous section to get $\frac{U^2}{H^2} \approx N^2$
<ul>
<li>For the Ocean, U ~ 0.1 m/s, H ~ 1km, N ~ 1E-2 s^{-1}. Hence $\frac{U^2}{H^2N^2} \approx 1E-4$. Not even close to 1</li>
<li>This means that the scaling that was used in the case without stratification is not appropriate
<ul>
<li>Instead of scaling $N^2$, we scale w instead
<ul>
<li>Define the Froude number: $Fr = \frac{U}{NH}$</li>
<li>$w = (Fr)^2\frac{H}{L}U$. This enables proper scaling</li>
</ul>
</li>
</ul>
</li>
<li>Going back to hydrostatic balance: $\frac{Dw}{\cancel{D}t} = -\frac{\partial \phi&rsquo;}{\partial z}+b'$
<ul>
<li>Doing the scaling analysis to get that $(Fr)^2(\frac{H}{L})^2\frac{U^2}{L} \approx \frac{U^2}{L}$</li>
<li>Taking the ratio of the LHS to the RHS yields that $\frac{\frac{Dw}{\cancel{D}t}}{b&rsquo;} \approx (Fr)^2(\frac{H}{L})^2$
<ul>
<li>Because of the squared Froude number, hydrostatic balance is an even better approximation
<ul>
<li>If you have strong stratification ($FR &laquo; 1$), this apply hydrostatic balance to deep fluids (ie $\frac{H}{L}$ need not be small)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="with-rotation">With Rotation<a hidden class="anchor" aria-hidden="true" href="#with-rotation">#</a></h4>
<ul>
<li>We now let $\Omega$ be nonzero</li>
<li>Looking at the horizontal momentum equation
<ul>
<li>$\frac{D}{\cancel{D}t}\vec{u} + \vec{f}\times\vec{u} = \frac{-1}{\rho}\nabla p$
<ul>
<li>$\vec{f} = 2\Omega \sin\theta \hat{k}$</li>
</ul>
</li>
<li>Apply scalar analysis to the this equation (f has units of $f$) to get that the ratio of the horizontal acceleration to the coreolis acceleration is
<ul>
<li>$\frac{\frac{U^2}{L}}{fU} \approx \frac{U}{fL} = R_o$</li>
<li>$R_o$ is the Rossby number</li>
<li>$\Omega = \frac{2\pi}{24\ hr}$ is 7.27E-5 Hz</li>
<li>f at mid latitudes ($\theta = 45$) is 1E-4 1/s</li>
<li>For the atmosphere, $R_o \approx 0.1 &laquo; 1$</li>
<li>For the ocean, $R_o \approx 0.01 &laquo; 1$</li>
</ul>
</li>
<li>Rapidly rotating fluids have small $R_0$</li>
</ul>
</li>
</ul>
<h4 id="time-scales">Time scales<a hidden class="anchor" aria-hidden="true" href="#time-scales">#</a></h4>
<ul>
<li>We can define time scales in an analagous manner</li>
<li>Advective: $\frac{L}{U} \approx$ 27 hrs for the atmosphere and 1E6 hrs for the ocean</li>
<li>Rotation: $\frac{1}{f} \approx $ 3 hrs for Earth</li>
<li>GFD forces are slow in comparison to rotation.
<ul>
<li>This means that we can drop $\frac{Du}{\cancel{D}t}$
<ul>
<li>$\vec{f}\times \vec{u_g} = \frac{-1}{\rho}\nabla p$
<ul>
<li>This is called Geostrophic balance</li>
</ul>
</li>
<li>In spherical coordinates, you can write the above as $fv_g = \frac{1}{a\rho \cos \theta}\frac{\partial p}{\partial \lambda}$ and $fu_g = \frac{-1}{a\rho}\frac{\partial p}{\partial \theta}$ where $\theta$ is latitude and $\lambda$ is longitude</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="geostrophic-flow">Geostrophic flow<a hidden class="anchor" aria-hidden="true" href="#geostrophic-flow">#</a></h4>
<ul>
<li>Flow along lines of constant pressure w/ high pressure to the right for $f &gt; 0$</li>
<li>From horizontal momentum equations, we know (if f and $\rho$ are constant) that $\nabla u_g = 0$ and $\zeta_g = \hat{k} \cdot \nabla \times u_g = \frac{1}{\rho_0 f_{0}} \nabla^2 p$
<ul>
<li>If you are give the vorticity $\zeta_{g}$, then you can solve Poisson&rsquo;s equation to solve for P</li>
</ul>
</li>
<li>We can modify this by letting $f = f_0+\beta y$. This causes the rotation to be felt more at the poles and less at the equator</li>
<li>Plugging this into the geostrophic balance equation and turning the crank (taking mixed partials, equating and doing derivative) yields
<ul>
<li>$f \frac{\partial w}{\partial z} = \beta v_g$</li>
<li>This is called the Sverdrup balance</li>
</ul>
</li>
</ul>
<h4 id="taylor-proudman-theorem">Taylor-Proudman Theorem<a hidden class="anchor" aria-hidden="true" href="#taylor-proudman-theorem">#</a></h4>
<ul>
<li>If $\beta=0$, $f = f_0$, and $\rho = \rho_0$ then $\frac{\partial w}{\partial z} = 0$</li>
<li>In words, geostrophy + hydrostatic balance+ constant f and rho implies that the geostrophic flow is independent of height</li>
</ul>
<h3 id="thermal-wind-balance">Thermal Wind Balance<a hidden class="anchor" aria-hidden="true" href="#thermal-wind-balance">#</a></h3>
<ul>
<li>Combine geostrophy and hydrostatic balance with Bousinesq
<ul>
<li>$\vec{f}\times \vec{u_g} = -\nabla \phi$</li>
<li>$\frac{\partial \phi }{\partial x} = b$</li>
</ul>
</li>
<li>Take $\frac{\partial }{\partial z}$ of the first and use the second to demonstrate that
<ul>
<li>$\vec{f}\times\frac{\partial \vec{u}_g}{\partial z} = -\nabla b$</li>
<li>In Component form:
<ul>
<li>$\frac{\partial u_g}{\partial z} = -\frac{\partial b}{\partial y}$</li>
<li>$\frac{\partial v_g}{\partial z} = \frac{\partial b}{\partial x}$</li>
</ul>
</li>
<li>Use the equation of state $\rho = \rho_0[1-\beta(T-T_0)]$
<ul>
<li>Since $b = -\frac{\delta \rho}{\rho}, g$ Hot water is light water which is buoyant water</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="gravity-waves">Gravity Waves<a hidden class="anchor" aria-hidden="true" href="#gravity-waves">#</a></h3>
<ul>
<li>Suppose that we have an incompressible fluid $\nabla\cdot v = 0$ and that $\frac{D b}{\cancel{D}t} = 0$</li>
<li>Boussinesq states that
<ul>
<li>$\frac{Du}{\cancel{D}t} = -\nabla\phi$</li>
<li>$\frac{Dw}{\cancel{D}t} = -\frac{\partial \phi}{\partial z}+b$</li>
<li>We want to linearize around a stationary point
<ul>
<li>For simplicity, assume we are in 2D
<ul>
<li>$u = u(x,z,t)$</li>
<li>$v = u(x,z,t)$</li>
<li>$w=0$</li>
</ul>
</li>
<li>Linearize $\phi$ and $b$ into ~ and ' parts and assume hydrostatic balance $\frac{\partial \tilde{\phi}}{\partial z} = \tilde{b}$
<ul>
<li>$u_t^{'} = -\phi_x^{'}$</li>
<li>$w_t^{'} = -\phi_z^{'}+b'$</li>
<li>$u_x^{'} = -w_z^{'}$</li>
<li>$b_t^{'} = -w^{'}N^2$</li>
</ul>
</li>
<li>Taking the appropriate partials and writing everything in terms of w to get that
<ul>
<li>$w_{ttxx}^{'} +w_{zztt}^{'}+N^{2}w_{xx}^{'}$</li>
<li>Assume solutions of the form $w = W exp(i(kx+mz-\omega t))$</li>
<li>The dispersion relation is then: $\omega  = \frac{N^2k^2}{k^2+m^2} \rightarrow \frac{\omega}{N} = \sqrt{\frac{\kappa^2}{1+\kappa^2}}$</li>
<li>As $\kappa$ goes to zero, the horizontal motion is much greater than the vertical motion. The horizontal motion must complete in time with the the vertical motion. Hence small $\omega$</li>
<li>Conversely, if the vertical motion is much greater than the horizontal motion, then $\omega \rightarrow N$, or the maximum allows frequency due to gravity</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="shallow-water-theory">Shallow Water Theory<a hidden class="anchor" aria-hidden="true" href="#shallow-water-theory">#</a></h3>
<ul>
<li>One layer of constant density $\rho_0$ , possibly rotating, bounded by a rigid surface below and a free surface above
<ul>
<li>Let $\eta_b(x,y)$ be the surface of the rigid surface below</li>
<li>Let h be the distance between the free surface and the rigid surface</li>
<li>Let $\eta$ be the distance between the free surface to the reference level $z=0$</li>
<li>Assume hydrostatic balance $\frac{dP}{dt} = -\rho_0 g$
<ul>
<li>$P(x,y,z,t) = -\rho_o g\zeta+P_o$
<ul>
<li>Let $P_0 = 0$ when $z = \eta$</li>
</ul>
</li>
<li>We then can say that $P(x,y,z,t) = \rho_0 g (\eta(x,y,t)-z)$</li>
<li>Take partials w.r.t. x and y and observe that gradients of pressure (forces) are independent of theory</li>
<li>$\frac{D\vec{u}}{\cancel{D}t} + \vec{f}\times \vec{u} = \frac{-1}{\rho_0}\nabla P = -g \nabla \eta$
<ul>
<li>$\vec{u} = u\hat{i}+v\hat{j}$</li>
</ul>
</li>
<li>We also need conservation of mass $\nabla \cdot \vec{v} = 0 \rightarrow \frac{\partial w}{\partial z} = -\nabla \cdot \vec{u}$
<ul>
<li>Integrate along z from $\eta_b$ to $\eta$
<ul>
<li>$w(\eta)-w(\eta_b) = -\nabla\cdot u (\eta-\eta_b)$</li>
<li>Note that $w(\eta) = \frac{D\eta}{\cancel{D}t}$ and that $w(\eta_b) = \frac{D\eta_b}{\cancel{D}t} \neq 0$ due to positional changes</li>
<li>$\frac{D}{\cancel{D}t}(\eta-\eta_b)+h \nabla\cdot u = 0 \rightarrow \frac{\partial \eta}{\partial t} +\nabla \cdot [(\eta-\eta_b)\vec{u}]=0$</li>
</ul>
</li>
</ul>
</li>
<li>$\frac{D}{\cancel{D}t}\frac{z-\eta_b}{\eta-\eta_b}=0$
<ul>
<li>This comes from integrating conservation of mass from $z=\eta_b$ to z and then making the substitution $\nabla \cdot \vec{u} = \frac{-1}{h}\frac{Dh}{\cancel{D}t} = \frac{-1}{\eta-\eta_b}\frac{D}{\cancel{D}t}(\eta-\eta_b)$</li>
<li>This states that no water flows up or down the column in shallow water equations (&ldquo;no social mobility&rdquo;)</li>
<li>$\frac{z-\eta_b}{\eta-\eta_b}=0$ is a conserved quantity</li>
</ul>
</li>
<li>Another important quantity is $\nabla \times \vec{v}$ or the vorticity. Since we have a 2D flow, we only care about the k component: $\nabla\times\vec{u}\cdot\hat{k} = \frac{\partial u}{\partial x}-\frac{\partial u}{\partial y} = \zeta$
<ul>
<li>Importantly, Vorticity is NOT a conserved quantity</li>
<li>However, $\frac{D}{\cancel{D}t}(\frac{\zeta+f}{h}) = 0$ is conserved</li>
</ul>
</li>
<li>Kinetic Energy
<ul>
<li>$\frac{KE}{Vol} = \int_{\eta}^{\eta_a} \rho_0\frac{\vec{u}^2}{2} dz = \rho_0\frac{\vec{u}^2}{2} (\eta-\eta_b)$</li>
</ul>
</li>
<li>Potential Energy
<ul>
<li>$\int_{\eta_b}^{\eta} \rho_0 g z dz = \rho_o g(\eta^2-\eta_b^2)$</li>
</ul>
</li>
<li>Setting $\eta_b=0$ and take $\frac{\partial}{\partial t}$ of the KE and PE sum. After lots of algebra:
<ul>
<li>$\frac{\partial}{\partial t}(EK+PE)+\nabla\cdot(\vec{u}(gh^2+\frac{h\vec{u}^{2}}{2})) = 0 \rightarrow \frac{\partial E}{\partial t}(E) = \nabla\cdot F = 0$</li>
<li>Using Stoke&rsquo;s Law on the entire volume under consideration:
<ul>
<li>$\frac{\partial}{\partial t}\int E dA+\oint \vec{F}\cdot\hat{n}\vec{dl} = 0$</li>
<li>Since $\vec{u}$ is orthogonal to $\hat{n}$, the closed integral is zero.</li>
<li>Hence energy E is conserved</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="gas-dynamics-connection">Gas Dynamics Connection<a hidden class="anchor" aria-hidden="true" href="#gas-dynamics-connection">#</a></h4>
<ul>
<li>Shallow Water Equations with $\vec{f}=0$ and $\eta_b = 0$</li>
<li>$\frac{D\vec{u}}{\cancel{D}t} = -g\nabla \eta$</li>
<li>$\frac{\partial \eta}{\partial t}+ \nabla\cdot (\eta\vec{u}) = 0$</li>
<li>Gass Dynamics
<ul>
<li>$\frac{D\vec{u}}{\cancel{D}t} = \frac{-1}{\rho} \nabla P$</li>
<li>$\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho\vec{u}) = 0$</li>
<li>Equation of state $P = C\rho^{\gamma}$</li>
</ul>
</li>
<li>If we let $\gamma = 2$ and $C\gamma = g$, the above as isomorphic</li>
<li>If you linearize both equations, these are isomorphic for all $\gamma$</li>
</ul>
<h4 id="reduced-gravity-model">Reduced Gravity Model<a hidden class="anchor" aria-hidden="true" href="#reduced-gravity-model">#</a></h4>
<ul>
<li>You have two fluid layers $\rho_1$ and $\rho_2$. Let $\rho_1 &lt; \rho_2$ The upper layer 1 is moving in x and y and the lower layer 2 is stationary. z extends to $-\infty$. Above the upper interface, we have a free surface at $z=\eta_0$. The boundary between the two layers is at $z = \eta_1$</li>
<li>We integrate the hydrostatic balance equation from $\eta_0$ to z where z is not in in the stationary layer
<ul>
<li>$P_1 = g\rho_1(\eta_0-z)$</li>
<li>$\frac{1}{\rho_1}\nabla(P_1) = g \nabla \eta_0$</li>
<li>$\frac{D\vec{u}}{\cancel{D}t} = \vec{f}\times \vec{u} = -g\nabla \eta_0$</li>
</ul>
</li>
<li>We can then integrate up to $\eta_1$ in layer 1, then from $\eta_1$ to z in layer 2</li>
<li>$P_2 = \rho_1 g(\eta_0-\eta_1)+\rho_2 g(\eta_1-z)$</li>
<li>This can be rearranged to $g\eta_0 = -(\frac{\rho_2-\rho_1}{\rho_1})g\eta_1+constants \rightarrow g\eta_0+g&rsquo;\eta_1 = constant$
<ul>
<li>$g&rsquo; = \frac{\rho_2-\rho_1}{\rho_1}g$ is the reduced gravity
<ul>
<li>With this, if $\frac{\delta \rho}{\rho} &laquo; 1$, then $g'&laquo;g$. This means that $\eta_0&laquo;\eta_1$</li>
<li>We can make the rigid lid approximation in this limit by settin $\eta_0=0$</li>
<li>Turning the crank, we eventually find that
<ul>
<li>$(\rho_2-\rho_1)g\nabla h = \nabla P$</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>We eventually, with the tight lid approximation, the same equations as the shallow water equations with $g = g'$</li>
</ul>
<h3 id="2-layer-shallow-water">2 Layer Shallow Water<a hidden class="anchor" aria-hidden="true" href="#2-layer-shallow-water">#</a></h3>
<ul>
<li>$\frac{D\vec{u_1}}{\cancel{D}t}+\vec{f}\times\vec{u_2} = -g\nabla\eta_0$</li>
<li>$\frac{D\vec{u_2}}{\cancel{D}t}+\vec{f}\times\vec{u_2} = \frac{-\rho_1}{\rho_2}(g\nabla\eta_0+g^{'}\nabla\eta_1)$
<ul>
<li>$g&rsquo; = \frac{\rho_2-\rho_1}{\rho_1}g$</li>
</ul>
</li>
<li>There are also the conservation of mass equations, but those aren&rsquo;t coupled</li>
<li>Let&rsquo;s look at steady state solutions (geostrophic ie. time partials are zero). With some algebra and vector identities
<ul>
<li>$f(\vec{u_1-u_2}) = k\hat{k}\times g^{'}\nabla\eta_{1}$</li>
<li>Physically, the horizontal slope of the interface ($z = \eta_1$) is related to vertical velocities (and vice versa)</li>
<li>We can think of the gradient of $\eta_1$ as a proxy for temperature (because fluctuations in density can be related to temperature)</li>
</ul>
</li>
<li>Now let&rsquo;s examine the waves that are permitted, keeping $\eta_b = 0$
<ul>
<li>Assume a stationary medium of height N and linearize
<ul>
<li>$\vec{u} = 0+ \vec{u&rsquo;}$</li>
<li>$\eta = H+\eta'$</li>
</ul>
</li>
<li>$\frac{\partial \vec{u&rsquo;}}{\partial t}+\vec{f}\times\vec{u&rsquo;}  = -g \nabla\eta'$</li>
<li>$\frac{\partial \vec{u&rsquo;}}{\partial t}+ H\nabla\cdot\vec{u&rsquo;}= 0$</li>
<li>For simplicity, let $\vec{f} = 0$
<ul>
<li>We can eliminate $\vec{u&rsquo;}$ and solve for $\eta'$.</li>
<li>We see that we get a wave equation
<ul>
<li>$\frac{\partial^2\eta&rsquo;}{\partial t^2} = (gH)\nabla^{2}\eta'$</li>
<li>the speed in the medium is $c^2 = gH$
<ul>
<li>This is why waves break at the shoreline (waves in deeper water over take waves near the beach and break)</li>
</ul>
</li>
<li>We can solve this with phasors. Let $\eta&rsquo; = \eta_0 exp(i(kx-\omega  t))$. Plug in and solve for $\omega = \pm ck$
<ul>
<li>We see that phase velocity is c and group velocity is c</li>
<li>This is a non-dispersive wave, so the initial shape of the wave is maintained</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Now, we let $f = f_0$. This rotation couples the x and y directions
<ul>
<li>We can write everything out in component form, and then make the assumption that all the fluctionations have the form $A&rsquo; = Aexp(i(kx+lk-\omega t))$, we can rewrite  the above as a matrix equation $Ax = 0$ and solve for values of $\omega$ that causes the matrix A to be singular (ie det A = 0)
<ul>
<li>The characteristic equation is $\omega(\omega^2-f_0^2-(k^2+l^2)gH) = 0$
<ul>
<li>$\omega = 0 \rightarrow \frac{\partial}{\partial t} = 0$. Plugging back into linearized equations, we recover geostrophy and conservation of mass. We also see that $\eta'$ is degenerate (ie any $\eta'$ works)</li>
<li>The other modes are $\frac{\omega^2}{f_0^2} = 1+\frac{gH(k^2+l^2)}{f_0^2}$
<ul>
<li>In the limit that $k^2+l^2 &raquo; 1$, we see that we recover the non-rotating case (gravity dominated)
<ul>
<li>The wavelengths are small, hence they don&rsquo;t feel the rotation of the Earth</li>
</ul>
</li>
<li>The other limit with big wavelengths ($k^2+l^2&laquo;1$) only feel the effect of rotation and ignores gravity (rotation dominated)</li>
<li>For these waves, if $\eta'=0$ then there are no pressure gradients (inertial oscillations)</li>
</ul>
</li>
<li>$L_R = \frac{\sqrt{g H}}{f_0}$ is the Rossby radius or the &ldquo;Deformation radius&rdquo;
<ul>
<li>the free surface is being deformed once you reach lengths scales above this scale ($L &raquo; L_R$)</li>
<li>for $L &laquo; L_R$, gravity dominates</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://mushetty.me">mushetty.me</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
